webpackJsonp([20],{685:function(e,t,i){"use strict";var s={name:"page",props:{pageIndex:{type:Number,default:1,required:!0},pageSize:{type:Number,default:1,required:!0},total:{type:Number,default:0,required:!0},pageSizesList:{type:Array,required:!0}},data:function(){return{}},methods:{handleSizeChange:function(e){this.$emit("handleSizeChange",e)},handleCurrentChange:function(e){this.$emit("handleCurrentChange",e)},firstPage:function(){this.pageIndex=1},tailPage:function(){this.pageIndex=this.$refs.page.internalPageCount}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page"},[i("el-pagination",{ref:"page",attrs:{background:"","current-page":e.pageIndex,"page-sizes":e.pageSizesList,"page-size":e.pageSize,"prev-text":e.$t("UserPicker.HomePage"),"next-text":e.$t("UserPicker.TailPage"),layout:"total, prev, pager, next, sizes",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"prev-click":e.firstPage,"next-click":e.tailPage}})],1)},staticRenderFns:[]};var n=i(47)(s,a,!1,function(e){i(687)},"data-v-18a42a56",null).exports;t.a=n},687:function(e,t){},688:function(e,t,i){"use strict";var s,a=i(360),n=i.n(a),r=i(163),c=i.n(r),o=i(160),l=i.n(o),d=i(357),h=i(67),p={name:"",props:{componentParam:{componentType:{type:String,required:!0},childDataUrl:{type:Object,required:!0},backfillData:{type:Array,default:new Array,required:!0},assemblyParam:{type:Object,required:!0},checkProcess:{type:Boolean,default:!1,required:!0},oneCheck:{type:Boolean,default:!1,required:!0},closeShow:{type:Boolean,default:!0,required:!0},type:Object,required:!0}},mounted:function(){if(this.componentParam.backfillData.length>0){var e=!0,t=!1,i=void 0;try{for(var s,a=l()(this.componentParam.backfillData);!(e=(s=a.next()).done);e=!0){var n=s.value;this.selectedCities.push(n)}}catch(e){t=!0,i=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw i}}}},data:function(){return{checkedCities:[],selectedCities:[],processName:"",organizeProcessName:"",organName:"",selectOrgs:[],isActive:!1,checkAll:!1,cities:[],treeSearch:"",treeList:[],rootNode:{},defaultProps:{id:"id",children:"Child",label:"name"},tooltiprocessName:"",defaultKeys:[],currentId:"",isIndeterminate:!1,props:{label:"orgName",value:"orgID",children:"m_ChildOrg"},organizeList:[],activeOrganizeName:[],organizeName:"",organize:{orgID:""},imgLoading:!1}},watch:{treeSearch:function(e){this.debouncedSearchTree()}},created:function(e){var t=this;t.debouncedSearchTree=Object(d.debounce)(t.searchTree,2e3),t.debouncedGetProcess=Object(d.debounce)(t.getProcess,200,e),t.imgLoading=!0,c.a.all([t.getOrganizeList(),t.getUserOrganize()]).then(function(e){if(e[0]){t.organize.orgID=e[1]||t.organizeList[0].orgID;var i=t.$refs.orgtree.getNode(t.organize.orgID);i&&(t.$refs.orgtree.setCurrentKey(t.organize.orgID),t.setOrganize(i)),t.getCategoryOfOrganize(t.organize.orgID).then(function(){t.imgLoading=!1})}}).catch(function(e){t.imgLoading=!1,t.$message.error(e)})},methods:(s={selectTreeClick:function(e,t){var i=this;this.processName="",this.tooltiprocessName="",i.$refs.selectTree.visible=!1,i.organize=e,i.setOrganize(t),i.imgLoading=!0,i.getCategoryOfOrganize(e.orgID).then(function(){i.imgLoading=!1}),i.cities=[],i.checkAll=!1,i.isIndeterminate=!1},setOrganize:function(e){this.activeOrganizeName=[],this.getOrgPrarentNode(e),this.organizeName=this.activeOrganizeName.reverse().join("/"),this.organizeProcessName=this.activeOrganizeName.join(">")+">"},getUserOrganize:function(){var e=this;return new c.a(function(t,i){e.$axios.post("/api/getorg",{}).then(function(e){if(e.data.getOrgList.length>0){var i=e.data.getOrgList[0].orgid;t(i)}else t(null)}).catch(function(e){i("获取用户所在部门失败!ERROR MESSAGE:"+e)})})},getOrganizeList:function(){var e=this;return new c.a(function(t,i){e.$axios.post("/api/companytree/page",{}).then(function(i){i.data.companyTreeList.length>0?(e.organizeList=i.data.companyTreeList,t(!0)):t(!1)}).catch(function(e){i("获取组织数据失败!ERROR MESSAGE:"+e)})})},getCategoryOfOrganize:function(e){var t=this,i={orgId:e,isUse:1,name:t.treeSearch.trim(),isHide:1,isDailog:"1"};return new c.a(function(e,s){t.$axios.post("/api/processCategory",i).then(function(i){if(0==i.data.result.length)t.treeList=[];else{for(var s=h.a.toTree(i.data.result,"id","pid","Child"),a=0;a<s.length;a++)0!=s[a].pid&&(s.splice(a,1),a--);t.treeList=s}e(!0)}).catch(function(e){s("查询列表数据失败!ERROR MESSAGE:"+e)})})},getOrgPrarentNode:function(e){void 0!=e.data.orgName&&this.activeOrganizeName.push(e.data.orgName),void 0!=e.parent&&this.getOrgPrarentNode(e.parent)},enterSearch:function(){this.defaultKeys=[],this.debouncedSearchTree()},searchTree:function(){var e=this;if(e.defaultKeys=[],""==e.treeSearch.trim())return e.imgLoading=!0,void e.getCategoryOfOrganize(e.organize.orgID).then(function(){e.imgLoading=!1});""!=e.organize.orgID?e.searchProcessCategory():e.$message.warning("请先选择组织进行搜索！")},searchProcessCategory:function(){var e=this;e.treeList.splice(0,e.treeList.length),e.cities.splice(0,e.cities.length),e.checkAll=!1,e.isIndeterminate=!1;var t={isCategory:"",isDailog:1,isHide:1,isUse:1,name:e.treeSearch.trim(),id:"",orgId:e.organize.orgID};e.imgLoading=!0,e.$axios.post("/api/processCategoryTree",t).then(function(t){if(0==t.data.result.length)e.treeList=[];else{var i=h.a.toTree(t.data.result,"id","pid","Child");e.treeList=i,e.getdefaultKeys(i)}e.imgLoading=!1}).catch(function(t){e.imgLoading=!1,e.$message.error("搜索组织流程失败！"+t)})},getProcess:function(e){if(e){var t=this,i=t.getSelectProcessId(t.selectedCities),s={isCategory:"0",isDailog:1,isHide:1,isUse:1,name:"",id:e.data.id,orgId:t.organize.orgID};t.imgLoading=!0,t.$axios.post("/api/processCategoryTree",s).then(function(e){t.displayProcess(e.data.result,i),t.imgLoading=!1}).catch(function(e){t.imgLoading=!1,t.$message.error("连接服务器失败！"+e)})}},handleNodeClick:function(e,t){if(0==this.treeSearch.trim().length)this.debouncedGetProcess(t);else if(this.treeSearch.trim().length>0){var i=this.getSelectProcessId(this.selectedCities),s=[];e.Child?s=e.Child:s.push(e),this.displayProcess(s,i)}this.selectOrgs=[],this.getPrarentNode(t),this.disposeOrganName(e.name)},getdefaultKeys:function(e){var t=!0,i=!1,s=void 0;try{for(var a,n=l()(e);!(t=(a=n.next()).done);t=!0){var r=a.value;r.hasOwnProperty("Child")&&r.Child.length>0&&(this.defaultKeys.push(r.id),this.getdefaultKeys(r.Child))}}catch(e){i=!0,s=e}finally{try{!t&&n.return&&n.return()}finally{if(i)throw s}}},displayProcess:function(e,t){this.cities.splice(0,this.cities.length),this.checkedCities=[],this.checkAll=!1,this.isIndeterminate=!1;var i=!0,s=!1,a=void 0;try{for(var n,r=l()(e);!(i=(n=r.next()).done);i=!0){var c=n.value;c.processId&&"0"!==c.processId&&null!==c.processId&&(t.indexOf(c.processId)>-1&&this.checkedCities.push(c),this.cities.push(c))}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}var o=this.getId(this.cities),d=0,h=!0,p=!1,u=void 0;try{for(var g,m=l()(this.checkedCities);!(h=(g=m.next()).done);h=!0){var f=g.value;-1!==o.indexOf(f.id)&&d++}}catch(e){p=!0,u=e}finally{try{!h&&m.return&&m.return()}finally{if(p)throw u}}this.checkAll=d>0&&d===this.cities.length,this.isIndeterminate=this.checkedCities.length>0&&this.checkedCities.length<this.cities.length},dblclickCheckedCitie:function(e){this.clickDepartment(e),this.$emit("sureSubmit",{type:this.componentParam.componentType,list:this.selectedCities})},clickDepartment:function(e){this.selectedCities.splice(0,this.selectedCities.length),this.selectedCities.push(e),this.checkedCities.splice(0,this.checkedCities.length),this.checkedCities.push(e);var t=this.$refs.processTree.getNode(e.pid);this.selectOrgs=[],this.getPrarentNode(t),e.tooltiprocessName=this.disposeOrganName(e.name)},handleCheckAllChange:function(e){this.checkedCities=[];var t=this.getSelectProcessId(this.selectedCities);if(e){var i=!0,s=!1,a=void 0;try{for(var n,r=l()(this.cities);!(i=(n=r.next()).done);i=!0){var c=n.value;-1===t.indexOf(c.processId)&&this.selectedCities.push(c),this.checkedCities.push(c)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}this.checkAll=!0,this.isIndeterminate=!1}else{var o=!0,d=!1,h=void 0;try{for(var p,u=l()(this.cities);!(o=(p=u.next()).done);o=!0){var g=p.value;if(t.indexOf(g.processId)>-1){var m=-1;for(var f in this.selectedCities)this.selectedCities[f].processId==g.processId&&(m=f);-1!=m&&this.selectedCities.splice(m,1)}}}catch(e){d=!0,h=e}finally{try{!o&&u.return&&u.return()}finally{if(d)throw h}}this.checkAll=!1,this.isIndeterminate=!1}},handleCheckedCitiesChange:function(e){this.isIndeterminate=!1;var t=[],i=!0,s=!1,a=void 0;try{for(var n,r=l()(this.selectedCities);!(i=(n=r.next()).done);i=!0){var c=n.value;t.push(c)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}this.selectedCities.splice(0,this.selectedCities.length);var o=this.getId(this.cities),d=[];for(var h in t)-1==o.indexOf(t[h].id)&&d.push(t[h]);this.selectedCities=d;var p=[],u=!0,g=!1,m=void 0;try{for(var f,v=l()(e);!(u=(f=v.next()).done);u=!0){var C=f.value;p.tooltiprocessName=this.disposeOrganName(C.name)}}catch(e){g=!0,m=e}finally{try{!u&&v.return&&v.return()}finally{if(g)throw m}}var y=this.getSelectProcessId(this.selectedCities),k=!0,b=!1,x=void 0;try{for(var w,_=l()(e);!(k=(w=_.next()).done);k=!0){var N=w.value;-1===y.indexOf(N.processId)&&this.selectedCities.push(N)}}catch(e){b=!0,x=e}finally{try{!k&&_.return&&_.return()}finally{if(b)throw x}}var S=0,I=!0,O=!1,z=void 0;try{for(var L,P=l()(e);!(I=(L=P.next()).done);I=!0){var D=L.value;-1!==o.indexOf(D.id)&&S++}}catch(e){O=!0,z=e}finally{try{!I&&P.return&&P.return()}finally{if(O)throw z}}this.checkedCities=e,this.checkAll=S===this.cities.length,this.isIndeterminate=S>0&&S<this.cities.length},pullBtnHeightChange:function(){this.isActive=!this.isActive},sureSubmit:function(){this.$emit("sureSubmit",{type:this.componentParam.componentType,list:this.selectedCities})},getSelectProcessId:function(e){var t=[],i=!0,s=!1,a=void 0;try{for(var n,r=l()(e);!(i=(n=r.next()).done);i=!0){var c=n.value;t.push(c.processId)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}return t},getId:function(e){var t=[],i=!0,s=!1,a=void 0;try{for(var n,r=l()(e);!(i=(n=r.next()).done);i=!0){var c=n.value;t.push(c.id)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}return t}},n()(s,"pullBtnHeightChange",function(){this.isActive=!this.isActive}),n()(s,"close",function(){this.$emit("hideComponent")}),n()(s,"deleteDept",function(e){for(var t in this.checkAll=!1,this.isIndeterminate=!1,this.checkedCities)this.checkedCities[t].id==this.selectedCities[e].id&&this.checkedCities.splice(t,1);this.selectedCities.splice(e,1),this.checkAll=this.checkedCities.length===this.cities.length&&this.cities.length>0,this.isIndeterminate=this.checkedCities.length>0&&this.checkedCities.length<this.cities.length}),n()(s,"clearDept",function(){this.checkedCities.splice(0,this.checkedCities.length),this.selectedCities.splice(0,this.selectedCities.length),this.checkAll=!1,this.isIndeterminate=!1}),n()(s,"disposeOrganName",function(e){var t="",i=!0,s=!1,a=void 0;try{for(var n,r=l()(this.selectOrgs);!(i=(n=r.next()).done);i=!0){t+=n.value.text+" > "}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}return t=(t=t.trim()).substr(0,t.length-1),this.tooltiprocessName=t,t.length>30?this.processName=t.substr(0,30)+"...":this.processName=t,t}),n()(s,"getPrarentNode",function(e){e&&(e.data&&void 0!=e.data.name&&this.selectOrgs.unshift({text:""+e.data.name,petId:""+e.data.id,PID:""+e.data.pid}),void 0!=e.parent&&this.getPrarentNode(e.parent))}),s)},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"originater_dialog newProcess_dialog"},[i("div",{class:[e.componentParam.closeShow?"pc-candidates":"pc-candidates pc-background"]},[i("div",{staticClass:"dialog_content"},[i("el-main",{staticStyle:{position:"relative"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.componentParam.closeShow,expression:"!componentParam.closeShow"}],staticClass:"top"},[e._v("流程选择\n          "),i("span",{staticStyle:{"font-size":"30px",cursor:"pointer"},on:{click:e.close}},[e._v("×")])]),e._v(" "),i("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],attrs:{type:"card","element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[i("el-tab-pane",{staticClass:"candidates-recently"},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont icon-todos"}),e._v(" 流程")]),e._v(" "),i("div",{staticClass:"title  title-border"},[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right",title:e.organizeProcessName+e.tooltiprocessName}},[i("el-breadcrumb-item",[e._v("流程选择")]),e._v(" "),i("el-breadcrumb-item",{staticStyle:{overflow:"hidden","-ms-text-overflow":"ellipsis","text-overflow":"ellipsis","white-space":"nowrap",width:"300px",display:"inline-block"}},[e._v(e._s(e.organizeProcessName)+e._s(e.processName))])],1),e._v(" "),i("span",{staticClass:"rightInput"},[i("el-input",{attrs:{placeholder:"请输入流程关键字","prefix-icon":"el-icon-search",size:"mini"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.enterSearch(t):null}},model:{value:e.treeSearch,callback:function(t){e.treeSearch=t},expression:"treeSearch"}})],1)],1),e._v(" "),i("div",{staticClass:"content clearfix"},[i("div",{staticClass:"content-left",staticStyle:{position:"relative"}},[i("div",{staticClass:"title"},[i("el-form",{staticClass:"demo-form-inline init-organize-box",staticStyle:{width:"100%"},attrs:{inline:!0}},[i("el-form-item",{staticStyle:{width:"100%"},attrs:{label:""}},[i("el-select",{ref:"selectTree",staticStyle:{width:"100%"},attrs:{placeholder:"组织","popper-class":"tree-list-box"},model:{value:e.organizeName,callback:function(t){e.organizeName=t},expression:"organizeName"}},[i("el-option",{staticStyle:{height:"auto",padding:"0px 0px"},attrs:{value:"",disabled:!0}},[i("div",[i("el-tree",{ref:"orgtree",attrs:{data:e.organizeList,"highlight-current":!0,"node-key":"orgID","default-expand-all":"","expand-on-click-node":!1,"empty-text":"暂无数据",props:e.props},on:{"node-click":e.selectTreeClick}})],1)])],1)],1)],1)],1),e._v(" "),e.treeList.length>0?i("el-tree",{ref:"processTree",attrs:{data:e.treeList,"node-key":"id","highlight-current":!0,props:e.defaultProps,"empty-text":"","expand-on-click-node":!1,"default-expanded-keys":e.defaultKeys},on:{"node-click":e.handleNodeClick}}):e._e(),e._v(" "),0===e.treeList.length?i("div",{staticStyle:{position:"absolute",top:"50%",left:"50%","-webkit-transform":"translate(-50%, -50%)","-moz-transform":"translate(-50%, -50%)","-ms-transform":"translate(-50%, -50%)","-o-transform":"translate(-50%, -50%)",transform:"translate(-50%, -50%)"}},[e._v("\n                  暂无数据\n                ")]):e._e()],1),e._v(" "),i("div",{staticClass:"content-right",staticStyle:{position:"relative"}},[e.componentParam.oneCheck?e._e():i("el-checkbox",{staticStyle:{"padding-top":"6px","padding-left":"20px"},attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选\n                ")]),e._v(" "),e.componentParam.oneCheck?i("el-checkbox-group",{staticClass:"theRadio",model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,function(t){return i("el-checkbox-button",{key:t.id,attrs:{label:t,checked:t.checked}},[i("div",{staticClass:"media"},[i("div",{staticClass:"media-body",on:{click:function(i){e.clickDepartment(t)},dblclick:function(i){e.dblclickCheckedCitie(t)}}},[i("h4",{staticClass:"media-heading iconfont icon-process1",attrs:{title:t.name}},[e._v(e._s(t.name.length>30?t.name.substr(0,30)+"...":t.name))])])])])})):i("el-checkbox-group",{staticClass:"mut-check",on:{change:e.handleCheckedCitiesChange},model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,function(t){return i("el-checkbox",{key:t.id,attrs:{label:t,checked:t.checked}},[i("div",{staticClass:"media"},[i("div",{staticClass:"media-body"},[i("h4",{staticClass:"media-heading",attrs:{title:t.name}},[e._v(e._s(t.name.length>30?t.name.substr(0,30)+"...":t.name))])])])])})),e._v(" "),0===e.cities.length?i("div",{staticStyle:{position:"absolute",top:"50%",left:"50%","-webkit-transform":"translate(-50%, -50%)","-moz-transform":"translate(-50%, -50%)","-ms-transform":"translate(-50%, -50%)","-o-transform":"translate(-50%, -50%)",transform:"translate(-50%, -50%)"}},[e._v("\n                  暂无数据\n                ")]):e._e()],1)]),e._v(" "),i("div",{staticClass:"addrecently-box",class:{pullup:e.isActive}},[i("div",{staticClass:"addrecently"},[i("div",{staticClass:"media"},[i("div",{staticClass:"pull",on:{click:e.pullBtnHeightChange}}),e._v(" "),i("ul",{staticClass:"clearfix"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedCities.length>0,expression:"selectedCities.length>0"}],staticClass:"clearBtn",on:{click:e.clearDept}}),e._v(" "),e._l(e.selectedCities,function(t,s){return i("li",{key:s},[i("div",{staticClass:"media-body"},[i("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.deleteDept(s)}}}),e._v(" "),i("span",{staticClass:"media-heading"},[e._v(e._s(t.name))])])])})],2)])])]),e._v(" "),i("div",{staticClass:"addrecently-footer"},[i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check-outline",size:"mini"},on:{click:e.sureSubmit}},[e._v("确定\n              ")]),e._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-close-outline",size:"mini"},on:{click:e.close}},[e._v("取消")])],1)])],1)],1)],1)])])},staticRenderFns:[]};var g=i(47)(p,u,!1,function(e){i(689)},"data-v-2617991c",null);t.a=g.exports},689:function(e,t){},690:function(e,t,i){"use strict";var s,a=i(360),n=i.n(a),r=i(160),c=i.n(r),o=i(163),l=i.n(o),d=(i(357),i(67)),h={name:"processClassification",props:{componentParam:{componentType:{type:String,required:!0},backfillData:{type:Array,default:new Array,required:!0},oneCheck:{type:Boolean,default:!1,required:!0},closeShow:{type:Boolean,default:!0,required:!0},type:Object,required:!0}},data:function(){return{tooltipclassificationName:"",classificationName:"",treeSearch:"",treeList:[],defaultKeys:[],defaultProps:{id:"id",children:"Child",label:"name"},checkedCities:[],selectedCities:[],selectOrgs:[],isActive:!1,checkAll:!1,isIndeterminate:!1,cities:[],currentId:"",rootNode:{},oldtime:0,props:{label:"orgName",value:"orgID",children:"m_ChildOrg"},organizeList:[],activeOrganizeName:[],organizeName:"",organize:{orgID:""},imgLoading:!1}},watch:{treeSearch:function(e){this.$refs.classificationTree.filter(e.trim())}},created:function(e){var t=this;t.imgLoading=!0,l.a.all([t.getOrganizeList(),t.getUserOrganize()]).then(function(e){if(e[0]){t.organize.orgID=e[1]||t.organizeList[0].orgID;var i=t.$refs.orgtree.getNode(t.organize.orgID);i&&(t.$refs.orgtree.setCurrentKey(t.organize.orgID),t.setOrganize(i)),t.getCategoryOfOrganize(t.organize.orgID).then(function(){t.imgLoading=!1})}}).catch(function(e){t.imgLoading=!1,t.$message.error(e)})},mounted:function(){if(this.componentParam.backfillData.length>0){var e=!0,t=!1,i=void 0;try{for(var s,a=c()(this.componentParam.backfillData);!(e=(s=a.next()).done);e=!0){var n=s.value;this.selectedCities.push(n)}}catch(e){t=!0,i=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw i}}}},methods:(s={selectTreeClick:function(e,t){var i=this;i.$refs.selectTree.visible=!1,i.organize=e,i.setOrganize(t),i.imgLoading=!0,i.getCategoryOfOrganize(e.orgID).then(function(){i.imgLoading=!1}),i.cities=[],i.checkAll=!1,i.isIndeterminate=!1},setOrganize:function(e){this.activeOrganizeName=[],this.getOrgPrarentNode(e),this.organizeName=this.activeOrganizeName.reverse().join("/")},getUserOrganize:function(){var e=this;return new l.a(function(t,i){e.$axios.post("/api/getorg",{}).then(function(e){if(e.data.getOrgList.length>0){var i=e.data.getOrgList[0].orgid;t(i)}else t(null)}).catch(function(e){i("获取用户所在部门失败!ERROR MESSAGE:"+e)})})},getOrganizeList:function(){var e=this;return new l.a(function(t,i){e.$axios.post("/api/companytree/page",{}).then(function(i){i.data.companyTreeList.length>0?(e.organizeList=i.data.companyTreeList,t(!0)):t(!1)}).catch(function(e){i("获取组织数据失败!ERROR MESSAGE:"+e)})})},getCategoryOfOrganize:function(e){var t=this,i={orgId:e,isUse:1,name:t.treeSearch,isHide:1,isDailog:"1"};return new l.a(function(e,s){t.$axios.post("/api/processCategory",i).then(function(i){if(0==i.data.result.length)t.$message.success("暂无数据"),t.treeList=[];else{for(var s=d.a.toTree(i.data.result,"id","pid","Child"),a=0;a<s.length;a++)0!=s[a].pid&&(s.splice(a,1),a--);t.treeList=s}e(!0)}).catch(function(e){s("查询列表数据失败!ERROR MESSAGE:"+e)})})},getOrgPrarentNode:function(e){void 0!=e.data.orgName&&this.activeOrganizeName.push(e.data.orgName),void 0!=e.parent&&this.getOrgPrarentNode(e.parent)},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},handleNodeClick:function(e,t){var i=this,s=(new Date).getTime();if(i.oldtime&&i.rootNode&&(s-i.oldtime<500&&i.rootNode.id==t.id))return i.clickDepartment(e),i.getChildNode(t.data.Child),void setTimeout(function(){i.$emit("sureSubmit",{type:i.componentParam.componentType,list:i.selectedCities})},300);i.oldtime=s,i.rootNode=t,i.displayContents(t.data),i.selectOrgs=[],i.getPrarentNode(t),i.disposeOrganName(e.name)},displayContents:function(e){var t=this.getId(this.selectedCities);if(this.cities=[],this.checkedCities=[],this.checkAll=!1,this.isIndeterminate=!1,e.hasOwnProperty("Child")){var i=!0,s=!1,a=void 0;try{for(var n,r=c()(e.Child);!(i=(n=r.next()).done);i=!0){var o=n.value;this.cities.push(o)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}var l=!0,d=!1,h=void 0;try{for(var p,u=c()(e.Child);!(l=(p=u.next()).done);l=!0){o=p.value;t.indexOf(o.id)>-1&&this.checkedCities.push(o)}}catch(e){d=!0,h=e}finally{try{!l&&u.return&&u.return()}finally{if(d)throw h}}}else t.indexOf(e.id)>-1&&this.checkedCities.push(e),this.cities.push(e);var g=this.getId(this.cities),m=0,f=!0,v=!1,C=void 0;try{for(var y,k=c()(this.checkedCities);!(f=(y=k.next()).done);f=!0){var b=y.value;-1!==g.indexOf(b.id)&&m++}}catch(e){v=!0,C=e}finally{try{!f&&k.return&&k.return()}finally{if(v)throw C}}this.checkAll=m>0&&m===this.cities.length,this.isIndeterminate=this.checkedCities.length>0&&this.checkedCities.length<this.cities.length},dblclickCheckedCitie:function(e){this.clickDepartment(e),this.$emit("sureSubmit",{type:"new_process_dialog",list:this.selectedCities})},clickDepartment:function(e){this.selectedCities.splice(0,this.selectedCities.length),this.selectedCities.push(e),this.checkedCities.splice(0,this.checkedCities.length),this.checkedCities.push(e);var t=this.$refs.classificationTree.getNode(e.pid);this.selectOrgs=[],this.getPrarentNode(t),e.tooltipclassificationName=this.disposeOrganName(e.name)},handleCheckAllChange:function(e){var t=this.getId(this.selectedCities);if(this.checkedCities=[],e){var i=!0,s=!1,a=void 0;try{for(var n,r=c()(this.cities);!(i=(n=r.next()).done);i=!0){var o=n.value;-1===t.indexOf(o.id)&&this.selectedCities.push(o),this.checkedCities.push(o)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}this.checkAll=!0,this.isIndeterminate=!1}else{var l=!0,d=!1,h=void 0;try{for(var p,u=c()(this.cities);!(l=(p=u.next()).done);l=!0){o=p.value;if(t.indexOf(o.id)>-1){var g=-1;for(var m in this.selectedCities)this.selectedCities[m].id==o.id&&(g=m);-1!=g&&this.selectedCities.splice(g,1)}}}catch(e){d=!0,h=e}finally{try{!l&&u.return&&u.return()}finally{if(d)throw h}}this.checkAll=!1,this.isIndeterminate=!1}},handleCheckedCitiesChange:function(e){var t=[],i=!0,s=!1,a=void 0;try{for(var n,r=c()(this.selectedCities);!(i=(n=r.next()).done);i=!0){var o=n.value;t.push(o)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}this.selectedCities.splice(0,this.selectedCities.length);var l=this.getId(this.cities),d=[];for(var h in t)-1==l.indexOf(t[h].id)&&(d.push(t[h]),w++);this.selectedCities=d;o=[];var p=!0,u=!1,g=void 0;try{for(var m,f=c()(e);!(p=(m=f.next()).done);p=!0){h=m.value;o.tooltipclassificationName=this.disposeOrganName(h.name)}}catch(e){u=!0,g=e}finally{try{!p&&f.return&&f.return()}finally{if(u)throw g}}var v=this.getId(this.selectedCities),C=!0,y=!1,k=void 0;try{for(var b,x=c()(e);!(C=(b=x.next()).done);C=!0){h=b.value;-1===v.indexOf(h.id)&&this.selectedCities.push(h)}}catch(e){y=!0,k=e}finally{try{!C&&x.return&&x.return()}finally{if(y)throw k}}var w=0,_=!0,N=!1,S=void 0;try{for(var I,O=c()(e);!(_=(I=O.next()).done);_=!0){var z=I.value;-1!==l.indexOf(z.id)&&w++}}catch(e){N=!0,S=e}finally{try{!_&&O.return&&O.return()}finally{if(N)throw S}}this.checkedCities=e,this.checkAll=w===this.cities.length,this.isIndeterminate=w>0&&w<this.cities.length},pullBtnHeightChange:function(){this.isActive=!this.isActive},sureSubmit:function(){this.$emit("sureSubmit",{type:this.componentParam.componentType,list:this.selectedCities})},getId:function(e){var t=[],i=!0,s=!1,a=void 0;try{for(var n,r=c()(e);!(i=(n=r.next()).done);i=!0){var o=n.value;t.push(o.id)}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}return t}},n()(s,"pullBtnHeightChange",function(){this.isActive=!this.isActive}),n()(s,"close",function(){this.$emit("hideComponent")}),n()(s,"deleteDept",function(e){for(var t in this.checkAll=!1,this.isIndeterminate=!1,this.checkedCities)this.checkedCities[t].id==this.selectedCities[e].id&&this.checkedCities.splice(t,1);this.selectedCities.splice(e,1),this.checkAll=this.checkedCities.length===this.cities.length&&this.cities.length>0,this.isIndeterminate=this.checkedCities.length>0&&this.checkedCities.length<this.cities.length}),n()(s,"clearDept",function(){this.checkedCities.splice(0,this.checkedCities.length),this.selectedCities.splice(0,this.selectedCities.length),this.checkAll=!1,this.isIndeterminate=!1}),n()(s,"disposeOrganName",function(e){var t="",i=!0,s=!1,a=void 0;try{for(var n,r=c()(this.selectOrgs);!(i=(n=r.next()).done);i=!0){t+=n.value.text+" > "}}catch(e){s=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(s)throw a}}return t=(t=t.trim()).substr(0,t.length-1),this.tooltipclassificationName=t,t.length>30?this.classificationName=t.substr(0,30)+"...":this.classificationName=t,t}),n()(s,"getPrarentNode",function(e){e&&(e.data&&void 0!=e.data.name&&this.selectOrgs.unshift({text:""+e.data.name,petId:""+e.data.id,PID:""+e.data.pid}),void 0!=e.parent&&this.getPrarentNode(e.parent))}),n()(s,"getChildNode",function(e){var t=!0,i=!1,s=void 0;try{for(var a,n=c()(e);!(t=(a=n.next()).done);t=!0){var r=a.value;this.selectedCities.push(r),r.hasOwnProperty("Child")&&r.Child.length>0&&this.getChildNode(r.Child)}}catch(e){i=!0,s=e}finally{try{!t&&n.return&&n.return()}finally{if(i)throw s}}}),s)},p={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"originater_dialog newProcess_dialog"},[i("div",{class:[e.componentParam.closeShow?"pc-candidates":"pc-candidates pc-background"]},[i("div",{staticClass:"dialog_content"},[i("el-main",{staticStyle:{position:"relative"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.componentParam.closeShow,expression:"!componentParam.closeShow"}],staticClass:"top"},[i("span",[e._v("流程分类选择")]),e._v(" "),i("span",{staticStyle:{"font-size":"30px",cursor:"pointer"},on:{click:e.close}},[e._v("×")])]),e._v(" "),i("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],attrs:{type:"card","element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[i("el-tab-pane",{staticClass:"candidates-recently"},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont icon-todos"}),e._v(" 流程")]),e._v(" "),i("div",{staticClass:"title  title-border"},[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right",title:e.tooltipclassificationName}},[i("el-breadcrumb-item",[e._v("流程分类选择")]),e._v(" "),i("el-breadcrumb-item",[e._v(e._s(e.classificationName))])],1),e._v(" "),i("span",{staticClass:"rightInput"},[i("el-input",{attrs:{placeholder:"请输入流程分类名","prefix-icon":"el-icon-search",size:"mini"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.enterSearch(t):null}},model:{value:e.treeSearch,callback:function(t){e.treeSearch=t},expression:"treeSearch"}})],1)],1),e._v(" "),i("div",{staticClass:"content clearfix"},[i("div",{staticClass:"content-left"},[i("div",{staticClass:"title"},[i("el-form",{staticClass:"demo-form-inline init-organize-box",staticStyle:{width:"100%"},attrs:{inline:!0}},[i("el-form-item",{staticStyle:{width:"100%"},attrs:{label:""}},[i("el-select",{ref:"selectTree",staticStyle:{width:"100%"},attrs:{placeholder:"组织","popper-class":"tree-list-box"},model:{value:e.organizeName,callback:function(t){e.organizeName=t},expression:"organizeName"}},[i("el-option",{staticStyle:{height:"auto",padding:"0px 0px"},attrs:{value:"",disabled:!0}},[i("div",[i("el-tree",{ref:"orgtree",attrs:{data:e.organizeList,"highlight-current":!0,"node-key":"orgID","default-expand-all":"","expand-on-click-node":!1,"empty-text":"暂无数据",props:e.props},on:{"node-click":e.selectTreeClick}})],1)])],1)],1)],1)],1),e._v(" "),i("el-tree",{ref:"classificationTree",attrs:{data:e.treeList,"node-key":"id","highlight-current":!0,props:e.defaultProps,"empty-text":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),i("div",{staticClass:"content-right"},[e.componentParam.oneCheck?e._e():i("el-checkbox",{staticStyle:{"padding-top":"6px","padding-left":"20px"},attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选\n                ")]),e._v(" "),e.componentParam.oneCheck?i("el-checkbox-group",{staticClass:"theRadio",model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,function(t){return i("el-checkbox-button",{key:t.id,attrs:{label:t,checked:t.checked}},[i("div",{staticClass:"media"},[i("div",{staticClass:"media-body",on:{click:function(i){e.clickDepartment(t)},dblclick:function(i){e.dblclickCheckedCitie(t)}}},[i("h4",{staticClass:"media-heading iconfont icon-process1",attrs:{title:t.name}},[e._v(e._s(t.name.length>30?t.name.substr(0,30)+"...":t.name))])])])])})):i("el-checkbox-group",{staticClass:"mut-check",on:{change:e.handleCheckedCitiesChange},model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,function(t){return i("el-checkbox",{key:t.id,attrs:{label:t,checked:t.checked}},[i("div",{staticClass:"media"},[i("div",{staticClass:"media-body"},[i("h4",{staticClass:"media-heading",attrs:{title:t.name}},[e._v(e._s(t.name.length>30?t.name.substr(0,30)+"...":t.name))])])])])}))],1)]),e._v(" "),i("div",{staticClass:"addrecently-box",class:{pullup:e.isActive}},[i("div",{staticClass:"addrecently"},[i("div",{staticClass:"media"},[i("div",{staticClass:"pull",on:{click:e.pullBtnHeightChange}}),e._v(" "),i("ul",{staticClass:"clearfix"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedCities.length>0,expression:"selectedCities.length>0"}],staticClass:"clearBtn",on:{click:e.clearDept}}),e._v(" "),e._l(e.selectedCities,function(t,s){return i("li",{key:s},[i("div",{staticClass:"media-body"},[i("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.deleteDept(s)}}}),e._v(" "),i("span",{staticClass:"media-heading"},[e._v(e._s(t.name))])])])})],2)])])]),e._v(" "),i("div",{staticClass:"addrecently-footer"},[i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check-outline",size:"mini"},on:{click:e.sureSubmit}},[e._v("确定\n              ")]),e._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-circle-close-outline",size:"mini"},on:{click:e.close}},[e._v("取消")])],1)])],1)],1)],1)])])},staticRenderFns:[]};var u=i(47)(h,p,!1,function(e){i(691)},"data-v-4306266d",null);t.a=u.exports},691:function(e,t){},746:function(e,t){},786:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(160),a=i.n(s),n=i(690),r=i(688),c=i(67),o=i(359),l=i(685),d={name:"staticReports",mounted:function(){},components:{processClassification:n.a,processSelection:r.a,page:l.a},data:function(){return{fullHeight:document.documentElement.clientHeight,model:{selectForm:{},companys:""},componentParam:{componentType:{type:String,required:!0},backfillData:{type:Array,required:!0},oneCheck:{type:Boolean,required:!0},closeShow:{type:Boolean,required:!0}},processName:"",processIDs:"",processList:[],processCategoryName:"",processCategoryIDs:"",processCategoryList:[],isShow:!0,arrt:"收起",icon:"el-icon-arrow-up",selectValue:"",OrgId:"",tableData:[],isShowtwo:!0,arrtTwo:"收起",iconTwo:"el-icon-arrow-up",showdialog:!1,showList:!1,id:"",imgLoading:!1}},methods:{search:function(){this.getList()},getList:function(){var e=this;if(0!==this.processIDs.length||0!==this.processCategoryIDs.length){this.imgLoading=!0;var t={processIDs:this.processIDs,processCategoryIDs:this.processCategoryIDs,orderBy:""};this.$axios.post("/api/GetProcessesReport/page",t).then(function(t){e.tableData=t.data.processesReportList,e.imgLoading=!1}).catch(function(t){e.imgLoading=!1,e.$message.error("查询列表数据失败!ERROR MESSAGE:"+t)})}else this.$message.warning("请选择流程分类或流程选择进行查询！")},showToggle:function(){this.isShow=!this.isShow,this.isShow?(this.arrt="收起",this.icon="el-icon-arrow-up"):(this.arrt="展开",this.icon="el-icon-arrow-down")},showToggleTwo:function(){this.isShowtwo=!this.isShowtwo,this.isShowtwo?(this.arrtTwo="收起",this.iconTwo="el-icon-arrow-up"):(this.arrtTwo="展开",this.iconTwo="el-icon-arrow-down")},exportList:function(){var e=this;o.a.startLoading({lock:!0,text:"数据量过大，正在拼命加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")});var t={processIDs:this.processIDs,processCategoryIDs:this.processCategoryIDs,orderBy:""};this.$axios.post("/api/exportExcelForTable",{tableName:"静态-统计有效流程模板数量",params:t},{responseType:"blob"}).then(function(e){o.a.endLoading();var t=e.data;c.a.exportSearchList("静态-统计有效流程模板数量",t)}).catch(function(t){o.a.endLoading(),e.$message.error("导出失败!ERROR MESSAGE:"+t)})},openDailog:function(e){this.componentParam.closeShow=!1,this.componentParam.componentType=e,this.componentParam.oneCheck=!1,"processClassification"==e?this.componentParam.backfillData=this.processCategoryList:"processSelection"==e&&(this.componentParam.backfillData=this.processList),this.showdialog=!0,c.a.showDailog_mask()},hideComponent:function(){this.showdialog=!1,c.a.hiddenDailog_mask()},showMsgfromchild:function(e){if(e.type&&"processClassification"==e.type){this.processCategoryList=e.list;var t=[],i=[],s=!0,n=!1,r=void 0;try{for(var c,o=a()(e.list);!(s=(c=o.next()).done);s=!0){var l=c.value;i.push(l.name),t.push(l.id+"")}}catch(e){n=!0,r=e}finally{try{!s&&o.return&&o.return()}finally{if(n)throw r}}this.processCategoryIDs=t.join(","),this.processCategoryName=i.join("；")}else if(e.type&&"processSelection"==e.type){this.processList=e.list;var d=[],h=[],p=!0,u=!1,g=void 0;try{for(var m,f=a()(e.list);!(p=(m=f.next()).done);p=!0){var v=m.value;h.push(v.name),d.push(v.processId+"")}}catch(e){u=!0,g=e}finally{try{!p&&f.return&&f.return()}finally{if(u)throw g}}this.processIDs=d.join(","),this.processName=h.join("；")}this.hideComponent()},reset:function(){var e=this;this.componentParam.backfillData=new Array,this.processList=new Array,this.processCategoryList=new Array,this.$nextTick(function(){e.model.companys="",e.id="",e.processName="",e.processIDs="",e.processCategoryName="",e.processCategoryIDs=""})}},computed:{},watch:{fullHeight:function(){return document.documentElement.clientHeight}}},h={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"staticReports"},[i("el-container",[i("el-header",{staticClass:"minWidth"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"staticReports minWidth loadingtext",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[i("el-row",{staticClass:"staticReports-header"},[i("el-col",{attrs:{span:17}},[i("span",{staticClass:"mz",on:{click:function(t){e.$router.back(-1)}}},[e._v("流程报表")]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),i("el-col",{staticClass:"statisticsMiddle",attrs:{span:7}},[i("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:e.search}},[e._v("搜索")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:e.reset}},[e._v("重置")])],1)],1),e._v(" "),i("div",{staticClass:"taticReports-content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"statement"},[i("el-row",[i("span",{staticClass:"fz16"},[e._v("静态-统计有效流程/模板数量")])]),e._v(" "),i("el-row",{staticClass:"staticReports-middle"},[i("el-col",{staticClass:"classification-select",attrs:{sm:3,md:1}},[i("span",[e._v("流程分类选择")])]),e._v(" "),i("el-col",{staticClass:"inputsuhu",attrs:{span:6}},[i("span",{on:{dblclick:function(t){e.openDailog("processClassification")}}},[i("i",{staticClass:"iconfont icon-organization pl5",on:{click:function(t){e.openDailog("processClassification")}}}),e._v(" "),i("el-input",{staticClass:"input-text",attrs:{disabled:"",title:e.processCategoryName},model:{value:e.processCategoryName,callback:function(t){e.processCategoryName=t},expression:"processCategoryName"}})],1)]),e._v(" "),i("el-col",{staticClass:"process-select",attrs:{sm:2,md:1,span:4}},[i("span",[e._v("流程选择")])]),e._v(" "),i("el-col",{staticClass:"inputsuhu",attrs:{span:6}},[i("span",{on:{dblclick:function(t){e.openDailog("processSelection")}}},[i("i",{staticClass:"iconfont icon-organization pl5",on:{click:function(t){e.openDailog("processSelection")}}}),e._v(" "),i("el-input",{staticClass:"input-text",attrs:{disabled:"",title:e.processName},model:{value:e.processName,callback:function(t){e.processName=t},expression:"processName"}})],1)])],1),e._v(" "),i("el-row",[i("el-col",{staticClass:"buttonWrap",attrs:{span:4}},[i("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",icon:"iconfont icon-export",size:"mini"},on:{click:e.exportList}},[e._v("导出\n                  ")])],1)],1)],1)]),e._v(" "),i("div",{staticClass:"taticReports-content"},[i("div",{staticClass:"statement"},[i("el-table",{ref:"singleTable",staticClass:"table",attrs:{data:e.tableData,"highlight-current-row":"",border:"",height:e.isShow?e.fullHeight-305:e.fullHeight-285}},[i("el-table-column",{attrs:{prop:"company",label:"公司",width:"450"}}),e._v(" "),i("el-table-column",{attrs:{prop:"processCnt",label:"流程数量"}}),e._v(" "),i("el-table-column",{attrs:{prop:"templateCnt",label:"模板总数"}}),e._v(" "),i("el-table-column",{attrs:{prop:"templateAvg",label:"流程平均模板数"}}),e._v(" "),i("el-table-column",{attrs:{prop:"stepAvg",label:"模板平均步骤数"}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.imgLoading,expression:"!imgLoading"}],attrs:{slot:"empty"},slot:"empty"},[i("p",{style:{marginTop:"23px"}},[e._v("暂无数据")])])],1)],1)])],1),e._v(" "),e.showdialog?i(e.componentParam.componentType,{tag:"component",attrs:{componentParam:e.componentParam},on:{hideComponent:e.hideComponent,sureSubmit:e.showMsgfromchild}}):e._e()],1)],1)],1)},staticRenderFns:[]};var p=i(47)(d,h,!1,function(e){i(746)},"data-v-9a142852",null);t.default=p.exports}});