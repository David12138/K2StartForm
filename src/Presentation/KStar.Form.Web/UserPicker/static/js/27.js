webpackJsonp([27],{726:function(t,e){},727:function(t,e){},728:function(t,e){},769:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(67),o=a(160),c=a.n(o),i={name:"popover_flowsheet",props:{data:{type:Object,required:!0}},created:function(){},data:function(){return{processHeight:(t=document.documentElement.clientHeight,(t<=650?t+60:t)-400),processInfo:{processDescriptions:""},flowChart:[],isVisible:!1};var t},methods:{showPopver:function(){var t=this;s.a.burialPoint("发起流程展开描述");var e=this;e.isVisible=!1,e.$axios.post("/api/processCategoryImg",{processId:e.data.processId}).then(function(e){if(e.data.result.processInfo){t.flowChart=e.data.result.itmes;var a=0,s=!0,o=!1,i=void 0;try{for(var r,n=c()(t.flowChart);!(s=(r=n.next()).done);s=!0){var l=r.value;l.activityRemarkList.unshift({activityID:"start_"+a,activityName:"开始"}),l.activeIndex=l.activityRemarkList.length,l.activityRemarkList=t.split(l.activityRemarkList),a++}}catch(t){o=!0,i=t}finally{try{!s&&n.return&&n.return()}finally{if(o)throw i}}}e.data.result.processInfo&&(t.processInfo=e.data.result.processInfo)}).catch(function(t){e.$message.error("获取流程图数据失败!ERROR MESSAGE:"+t)})},split:function(t){for(var e=[],a=Math.ceil(t.length/5);a>0;)e.push(t.slice(5*(a-1),5*a)),a--;return e=e.reverse()}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-popover",{attrs:{effect:"light","popper-class":"tooltip-table",trigger:"click",placement:"left-end","visible-arrow":!0},model:{value:t.isVisible,callback:function(e){t.isVisible=e},expression:"isVisible"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"flow-top"},[a("div",{staticClass:"title"},[t._v(t._s(t.data.name))]),t._v(" "),a("i",{staticClass:"iconfont icon-guanbipre",staticStyle:{position:"absolute",top:"10px",right:"10px"},on:{click:function(e){t.isVisible=!t.isVisible}}}),t._v(" "),a("table",[a("tr",{staticClass:"flowchart"},[a("th",{staticClass:"name"},[t._v("流程ID")]),t._v(" "),a("td",{staticClass:"des"},[a("span",[t._v(t._s(t.data.id))])])]),t._v(" "),a("tr",{staticClass:"flowchart"},[a("th",{staticClass:"name",attrs:{colspan:"1"}},[t._v("流程描述")]),t._v(" "),a("td",{staticClass:"des",attrs:{colspan:"3"}},[a("div",{domProps:{innerHTML:t._s(t.processInfo.processDescription)}})])])])])])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"flowchart-img",style:{"max-height":t.processHeight+"px"}},t._l(t.flowChart,function(e,s){return e.activityRemarkList.length>0?a("div",{key:s,staticClass:"subtitle"},[a("i",{staticClass:"line"}),t._v(" "),a("span",{staticClass:"processTitle"},[t._v(t._s(e.processTemplateName))]),t._v(" "),a("div",{},[a("el-steps",{attrs:{"align-center":"",active:e.activeIndex}},t._l(e.activityRemarkList,function(e,s){return a("div",{key:s,staticClass:"step-linerow"},t._l(e,function(t){return a("el-step",{key:t.activityID,staticStyle:{"word-break":"break-all"},attrs:{title:t.activityName.length>27?t.activityName.substr(0,25)+"...":t.activityName}})}))}))],1)]):t._e()}))])],1),t._v(" "),a("i",{staticClass:"iconfont icon-fangdanor",staticStyle:{color:"#AAB4BC","font-size":"12px","margin-left":"10px"},attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),t.showPopver(e)}},slot:"reference"})],1)},staticRenderFns:[]};var n=a(47)(i,r,!1,function(t){a(728)},"data-v-42f11226",null).exports,l=(a(82),{name:"initProcess",data:function(){return{mapProcessHeight:document.documentElement.clientHeight-250,loading:!1,activeTab:{RootProcess:0,SecodeProcess:0},styleobj:{"background-color":"#941C25"},searchProcessCode:"",mapData:{},checkValue:!1,categoryID:"",categoryID2:""}},components:{popover:n},created:function(){},mounted:function(){this.getMapProcessData()},methods:{getMapProcessData:function(){var t=this;t.loading=!0;var e={categoryID:this.categoryID,categoryID2:this.categoryID2,key:this.searchProcessCode,showAll:this.checkValue};t.$axios({url:"/Portal/WorkflowMap/GetWorkflowMapByCategoryId",method:"post",data:e}).then(function(e){200===e.data.code&&(t.mapData=e.data.data)}).catch(function(t){}),t.loading=!1},rootProcessTab:function(t,e){var a=this;a.loading=!0,this.activeTab.RootProcess=e,a.activeTab.SecodeProcess=0,this.categoryID=t.ID,this.categoryID2="";var s={categoryID:this.categoryID,categoryID2:this.categoryID2,key:this.searchProcessCode,showAll:this.checkValue};a.$axios.post("/Portal/WorkflowMap/GetWorkflowMapByCategoryId",s).then(function(t){200===t.data.code&&(a.loading=!1,a.mapData=t.data.data)}).catch(function(t){})},secodeProcessTab:function(t,e){var a=this;a.activeTab.SecodeProcess=e,a.loading=!0,this.categoryID2=t.ID;var s={categoryID:this.categoryID,categoryID2:this.categoryID2,key:this.searchProcessCode,showAll:this.checkValue};a.$axios.post("/Portal/WorkflowMap/GetWorkflowMapByCategoryId",s).then(function(t){200===t.data.code&&(a.loading=!1,a.mapData=t.data.data)}).catch(function(t){})},Collectchange:function(t){var e=this;if(t.IsFavorite){var a={processCode:t.ProcessCode};e.$axios({url:"/Portal/WorkflowMap/DelWorkflowFavorite",method:"POST",data:a}).then(function(a){200===a.data.code?t.IsFavorite=!t.IsFavorite:e.$message.success("收藏失败")}).catch(function(t){e.$message.error("数据获取失败!ERROR MESSAGE:"+t.message)})}else{var s={processCode:t.ProcessCode};e.$axios({url:"/Portal/WorkflowMap/AddWorkflowFavorite",method:"POST",data:s}).then(function(a){200===a.data.code?t.IsFavorite=!t.IsFavorite:e.$message.success("取消收藏失败")}).catch(function(t){e.$message.error("数据获取失败!ERROR MESSAGE:"+t.message)})}},start:function(t){window.open(t.StartUrl,"_blank")},searchProcess:function(){var t=this;t.loading=!0,this.activeTab.RootProcess=0,t.activeTab.SecodeProcess=0,this.categoryID="",this.categoryID2="";var e={categoryID:this.categoryID,categoryID2:this.categoryID2,key:this.searchProcessCode,showAll:this.checkValue};t.$axios({url:"/Portal/WorkflowMap/GetWorkflowMapByCategoryId",method:"post",data:e}).then(function(e){200===e.data.code&&(t.mapData=e.data.data)}).catch(function(t){}),t.loading=!1},changeCheckValue:function(){this.searchProcessCode="",this.searchProcess()}},computed:{bodyHeight:function(){return document.documentElement.clientHeight}}}),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"initProcess loadingtext",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("el-container",[a("el-header",[a("div",{staticClass:"top-header"},[a("el-row",{attrs:{type:"flex",justify:"start"}},[a("span",{staticClass:"top-breadCrumb"},[t._v("发起流程")])])],1)]),t._v(" "),a("div",{staticClass:"searchPro"},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:16}}),t._v(" "),a("el-col",{staticClass:"searchProflex",attrs:{span:8}},[a("el-checkbox",{on:{change:t.changeCheckValue},model:{value:t.checkValue,callback:function(e){t.checkValue=e},expression:"checkValue"}},[t._v("显示全部流程")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.searchProcess()}},model:{value:t.searchProcessCode,callback:function(e){t.searchProcessCode=e},expression:"searchProcessCode"}}),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.searchProcess}},[t._v("查询")])],1)],1)],1),t._v(" "),a("el-main",[a("div",{staticClass:"mainContaint"},[a("el-row",{staticStyle:{margin:"0 !important"},attrs:{gutter:24}},[a("el-col",{staticStyle:{padding:"0"}},[a("div",{staticClass:"middle-content"},[a("div",{staticClass:"process-map-content"},[a("div",{staticClass:"mapRoot"},[a("ul",{staticClass:"mapRoot-text-ul"},t._l(t.mapData.FirstLevelMap,function(e,s){return a("li",{key:e.ID,ref:"processdom",refInFor:!0,staticClass:"mapRoot-text",class:t.activeTab.RootProcess==s?"activeProcess":"",on:{click:function(a){t.rootProcessTab(e,s)}}},[t._v("\n                                   "+t._s(e.ProcessName))])}))]),t._v(" "),a("div",{staticClass:"mapFrist"},[a("ul",{staticClass:"mapRoot-text-ul"},t._l(t.mapData.SecondLevelMap,function(e,s){return a("li",{key:e.ID,staticClass:"mapRoot-text",class:t.activeTab.SecodeProcess==s?"activeProcess":"",on:{click:function(a){t.secodeProcessTab(e,s)}}},[t._v("\n                      "+t._s(e.ProcessName))])}))]),t._v(" "),a("div",{staticClass:"mapProcess",staticStyle:{"padding-top":"10px","border-box":"box-sizing"},style:{height:t.mapProcessHeight+"px"}},t._l(t.mapData.OtherLevelMap,function(e){return a("div",{staticClass:"mapRoot-text-ul borB",class:"Process"===e.SType?"progig":"clearfix"},[a("div",{staticClass:"fz16 fif"},["Category"===e.SType?a("div",{staticClass:"clearfix"},[a("p",{staticClass:"fz13 font-b"},[t._v("["+t._s(e.ProcessName)+"]")]),t._v(" "),t._l(e.Children,function(e,s){return a("div",{key:s,class:"Process"===e.SType?"fif-process":"fif-Category",attrs:{span:6}},["Process"===e.SType?a("div",[a("div",[e.StartUrl?a("i",{staticClass:"icon iconfont",class:e.IsFavorite?"icon-full-collect":"icon-collect",staticStyle:{"font-size":"14px","vertical-align":"middle"},on:{click:function(a){a.stopPropagation(),t.Collectchange(e)}}}):t._e(),t._v(" "),e.StartUrl?a("el-tooltip",{key:e.ID,attrs:{effect:"dark",content:e.ProcessName,placement:"right"}},[a("a",{staticClass:"fif-tag-pro",on:{click:function(a){a.stopPropagation(),t.start(e)}}},[t._v(t._s(e.ProcessName))])]):a("span",{staticClass:"noUrl"},[t._v(t._s(e.ProcessName))])],1)]):t._e(),t._v(" "),"Category"===e.SType?a("div",{staticClass:" fif-tag-content fif-tag-title"},[a("div",[a("p",{staticStyle:{width:"100%"}},[t._v("["+t._s(e.ProcessName)+"]")]),t._v(" "),t._l(e.Children,function(s){return e.Children?a("div",{staticClass:"fif-g"},[s.StartUrl?a("i",{staticClass:"icon iconfont",class:s.IsFavorite?"icon-full-collect":"icon-collect",staticStyle:{"font-size":"14px","vertical-align":"middle"},on:{click:function(e){e.stopPropagation(),t.Collectchange(s)}}}):t._e(),t._v(" "),s.StartUrl?a("el-tooltip",{key:e.ID,attrs:{effect:"dark",content:s.ProcessName,placement:"right"}},[a("a",{staticClass:"fif-tag-pro"},[t._v(t._s(s.ProcessName))])]):t._e(),t._v(" "),"Category"!==s.SType||s.StartUrl?t._e():a("span",[t._v("["+t._s(s.ProcessName)+"]")]),t._v(" "),"Process"!==s.SType||s.StartUrl?t._e():a("span",{staticClass:"noUrl"},[t._v(t._s(s.ProcessName))])],1):t._e()})],2)]):t._e()])})],2):a("div",{staticClass:"profif",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("div",[e.StartUrl?a("i",{staticClass:"icon iconfont",class:e.IsFavorite?"icon-full-collect":"icon-collect",staticStyle:{"font-size":"14px","vertical-align":"middle"},on:{click:function(a){a.stopPropagation(),t.Collectchange(e)}}}):t._e(),t._v(" "),e.StartUrl?a("el-tooltip",{key:e.ID,attrs:{effect:"dark",content:e.ProcessName,placement:"right"}},[a("a",{staticClass:"fif-tag-pro",on:{click:function(a){a.stopPropagation(),t.start(e)}}},[t._v(t._s(e.ProcessName))])]):a("span",{staticClass:"noUrl"},[t._v(t._s(e.ProcessName))])],1)])])])}))])])])],1)],1)])],1)],1)},staticRenderFns:[]};var p=a(47)(l,d,!1,function(t){a(726),a(727)},"data-v-7bcad640",null);e.default=p.exports}});