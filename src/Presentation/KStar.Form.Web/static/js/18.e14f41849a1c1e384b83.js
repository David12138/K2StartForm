webpackJsonp([18],{WPFS:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("BO1k"),o=s.n(a),r=s("Xg7m"),i=s("J9uR"),n=s("Lxn6"),l=(s("ve2v"),s("ts/9"),s("nSyc"),s("PJh5")),c=s.n(l),p=s("+vjY"),d=s("T//Y"),h=c()().day(0).format("YYYY-MM-DD"),m=c()().day(6).format("YYYY-MM-DD"),u=c()().startOf("month").format("YYYY-MM-DD"),g=c()().endOf("month").format("YYYY-MM-DD"),f=c()().startOf("quarter").format("YYYY-MM-DD"),D=c()().endOf("quarter").format("YYYY-MM-DD"),v=c()().startOf("year").format("YYYY-MM-DD"),y=c()().endOf("year").format("YYYY-MM-DD"),C={name:"",components:{page:d.a,processClassification:r.a,processSelection:i.a},mounted:function(){},data:function(){return{fullHeight:document.documentElement.clientHeight,organSelectRadio:"",isShow:!0,isShowReportCondition:!0,arrt:"收起",arrtReportCondition:"收起",icon:"el-icon-arrow-down",selectValue:1,tableData:[],startDate:"",finishDate:"",childDataUrl:{url:""},comp:{},showdialog:!1,pageSizesList:[10,20,50,100],model:{selectForm:{processIDs:"",processFullName:""},Date:[]},componentParam:{componentType:{type:String,required:!0},backfillData:{type:Array,required:!0},oneCheck:{type:Boolean,required:!0},closeShow:{type:Boolean,required:!0}},processName:"",processIDs:"",projectList:[],processList:[],OrgId:"",type:1,pageIndex:1,pageSize:10,total:0,orderBy:"",exportData:[],processCategoryName:"",processCategoryIDs:"",processCategoryList:[],imgLoading:!1}},methods:{change:function(){switch(this.selectValue){case 1:this.startDate=h,this.endDate=m;break;case 2:this.startDate=u,this.endDate=g;break;case 3:this.startDate=f,this.endDate=D;break;case 4:this.startDate=v,this.endDate=y;break;case 5:this.startDate=this.model.Date[0]?this.model.Date[0]+" 00:00:00":"",this.endDate=this.model.Date[1]?this.model.Date[1]+" 23:59:59":""}},showToggle:function(){this.isShow=!this.isShow,this.isShow?(this.arrt="收起",this.icon="el-icon-arrow-up"):(this.arrt="展开",this.icon="el-icon-arrow-down")},openDailog:function(e){this.componentParam.closeShow=!1,this.componentParam.componentType=e,this.componentParam.oneCheck=!1,"processClassification"==e?this.componentParam.backfillData=this.processCategoryList:"processSelection"==e&&(this.componentParam.backfillData=this.processList),this.showdialog=!0,n.a.showDailog_mask()},showMsgfromchild:function(e){if(e.type&&"processClassification"==e.type){this.processCategoryList=e.list;var t=[],s=[],a=!0,r=!1,i=void 0;try{for(var n,l=o()(e.list);!(a=(n=l.next()).done);a=!0){var c=n.value;s.push(c.name),t.push(c.id+"")}}catch(e){r=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw i}}this.processCategoryIDs=t.join(","),this.processCategoryName=s.join("；")}else if(e.type&&"processSelection"==e.type){this.processList=e.list;var p=[],d=[],h=!0,m=!1,u=void 0;try{for(var g,f=o()(e.list);!(h=(g=f.next()).done);h=!0){var D=g.value;d.push(D.name),p.push(D.processId+"")}}catch(e){m=!0,u=e}finally{try{!h&&f.return&&f.return()}finally{if(m)throw u}}this.processIDs=p.join(","),this.processName=d.join("；")}this.hideComponent()},getProcessID:function(e,t){var s=!0,a=!1,r=void 0;try{for(var i,n=o()(e);!(s=(i=n.next()).done);s=!0){var l=i.value;if(!l.Child)return void(l.processId&&"0"!==l.processId&&null!==l.processId?t.processId.push(l.processId+""):t.processCategoryIDs.push(l.id+""));this.getProcessID(l.Child,t),t.processName.push(l.name.trim())}}catch(e){a=!0,r=e}finally{try{!s&&n.return&&n.return()}finally{if(a)throw r}}},handleSizeChange:function(e){var t=""+e;this.pageIndex=1,this.pageSize=parseInt(t),this.getList()},handleCurrentChange:function(e){this.pageIndex=e,this.getList()},hideComponent:function(){this.showdialog=!1,n.a.hiddenDailog_mask()},sortChange:function(e){this.orderBy=("statusName"==e.prop?"status":e.prop)+" "+e.order.replace("ending",""),this.getList()},renderIcon:function(e,t){t.column;return e("i",{class:"iconfont icon-process"})},getList:function(){var e=this;if(0!==this.processIDs.length||0!==this.processCategoryIDs.length){this.imgLoading=!0;var t=this;t.change(),null==t.model.Date&&(t.model.Date=[]);var s={startDate:t.startDate,endDate:t.endDate,processIDs:this.processIDs,processCategoryIDs:this.processCategoryIDs,selectValue:t.selectValue,pageIndex:t.pageIndex-1,pageSize:t.pageSize,orderBy:this.orderBy};if(5==t.selectValue&&""==t.startDate&&""==t.endDate)return t.$message.warning("请选择日期"),void(this.imgLoading=!1);t.$axios.post("/api/reportForm/getHighestDynamicFlowBack",s).then(function(s){t.tableData=s.data.processList,t.model.selectForm.total=s.data.listCounts;for(var a=0;a<s.data.processList.length;a++)s.data.processList[a].returnRate=s.data.processList[a].returnRate+"%";e.imgLoading=!1}).catch(function(){e.imgLoading=!1,t.$message.error("查询失败")})}else this.$message.warning("请选择流程分类或流程选择进行查询！")},exportList:function(){var e=this;this.change(),p.a.startLoading({lock:!0,text:"数据量过大，正在拼命加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")});var t={tableName:"动态-流程-退回率最高的流程",params:{startDate:this.startDate,endDate:this.endDate,processIDs:this.model.selectForm.processIDs,processCategoryIDs:this.processCategoryIDs,selectValue:this.selectValue,pageIndex:0,pageSize:1e3,orderBy:this.orderBy}};null==this.model.Date&&(this.model.Date=[]),this.model.selectForm.startDate=this.model.Date[0]?this.model.Date[0]+" 00:00:00":"",this.model.selectForm.endDate=this.model.Date[1]?this.model.Date[1]+" 23:59:59":"",this.$axios.post("/api/exportExcelForTable",t,{responseType:"blob"}).then(function(e){for(var t=e.data,s=0;s<e.data.length;s++)e.data.processList[s].returnRate=e.data.processList[s].returnRate+"%";n.a.exportSearchList("动态-流程-退回率最高的流程TOP10",t),p.a.endLoading()}).catch(function(t){p.a.endLoading(),e.$message.error("导出Excel失败!ERROR MESSAGE:"+t)})},search:function(){this.getList()},refresh:function(){var e=this;this.componentParam.backfillData=new Array,this.processList=new Array,this.processCategoryList=new Array,this.$nextTick(function(){e.processName="",e.processIDs="",e.selectValue=1,e.model.Date="",e.startDate=h,e.endDate=m,e.processCategoryName="",e.processCategoryIDs=""})}},watch:{fullHeight:function(){return document.documentElement.clientHeight}},computed:{}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"staticReports "},[s("el-container",[s("el-header",[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"staticReports loadingtext minWidth",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[s("div",{staticClass:"taticReports-content"},[s("el-row",{staticClass:"staticReports-header",attrs:{type:"flex",justify:"space-between"}},[s("el-col",{staticClass:"titleMT",attrs:{span:17}},[s("span",{staticClass:"mz",on:{click:function(t){e.$router.back(-1)}}},[e._v("流程报表")]),s("i",{class:e.icon})]),e._v(" "),s("el-col",{staticClass:"titleBtn clearfix",attrs:{span:6}},[s("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.refresh}},[e._v("重置")]),e._v(" "),s("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.search}},[e._v("查询")])],1)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticClass:"statement reportCondition"},[s("span",{staticClass:"fz16"},[e._v("动态-流程-流程退回率统计")]),e._v(" "),s("el-row",{staticClass:"staticReports-middle lh35 staticReportsMiddle"},[s("el-col",{staticClass:"classSelect",attrs:{span:2,sm:4,md:1}},[s("span",[e._v("流程分类选择")])]),e._v(" "),s("el-col",{staticClass:"classSelectMR process-inputbox",attrs:{span:7}},[s("i",{staticClass:"iconfont icon-organization",on:{click:function(t){e.openDailog("processClassification")}}}),e._v(" "),s("span",{on:{dblclick:function(t){e.openDailog("processClassification")}}},[s("el-input",{attrs:{placeholder:"",disabled:!0,title:e.processCategoryName},model:{value:e.processCategoryName,callback:function(t){e.processCategoryName=t},expression:"processCategoryName"}})],1)]),e._v(" "),s("el-col",{attrs:{span:1}},[s("span",[e._v(" ")])]),e._v(" "),s("el-col",{staticClass:"processSelect",attrs:{span:2,sm:4,md:1}},[s("span",[e._v("流程选择")])]),e._v(" "),s("el-col",{staticClass:"process-inputbox",attrs:{span:6}},[s("i",{staticClass:"iconfont icon-organization",on:{click:function(t){e.openDailog("processSelection")}}}),e._v(" "),s("span",{on:{dblclick:function(t){e.openDailog("processSelection")}}},[s("el-input",{attrs:{placeholder:"",disabled:!0,title:e.processName},model:{value:e.processName,callback:function(t){e.processName=t},expression:"processName"}})],1)])],1),e._v(" "),s("el-row",{staticClass:"reportCondition-date reportConditionDate"},[s("el-col",{staticClass:"timeDuan",attrs:{span:2,sm:4,md:1}},[s("span",[e._v("时间段")])]),e._v(" "),s("el-col",{staticClass:"timeSelect",attrs:{span:8,sm:8}},[s("el-radio-group",{on:{change:e.change},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}},[s("el-radio",{attrs:{label:1}},[e._v("本周")]),e._v(" "),s("el-radio",{attrs:{label:2}},[e._v("本月")]),e._v(" "),s("el-radio",{attrs:{label:3}},[e._v("本季度")]),e._v(" "),s("el-radio",{attrs:{label:4}},[e._v("本年")]),e._v(" "),s("el-radio",{attrs:{label:5}},[e._v("其他")])],1)],1),e._v(" "),s("el-col",{staticClass:"space",attrs:{span:2,sm:4,md:1}},[s("span",[e._v(" ")])]),e._v(" "),5===e.selectValue?s("el-col",{attrs:{span:7,sm:6}},[s("div",{staticClass:"border"},[s("el-date-picker",{staticClass:"timeWidth",attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.model.Date,callback:function(t){e.$set(e.model,"Date",t)},expression:"model.Date"}})],1)]):e._e()],1),e._v(" "),s("el-row",[s("el-col",{staticClass:"buttonWrap buttonWrapTA",attrs:{span:4}},[s("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.exportList}},[s("i",{staticClass:"iconfont icon-export"}),e._v("导出")])],1)],1)],1),e._v(" "),s("div",{staticClass:"statement "},[s("el-table",{ref:"singleTable",staticClass:"tableWidth",attrs:{data:e.tableData,height:e.isShow?e.fullHeight-320:e.fullHeight-215,"highlight-current-row":"",border:""},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{prop:"processID",width:"200",sortable:"custom",label:"ID"}}),e._v(" "),s("el-table-column",{attrs:{prop:"processName",sortable:"custom",align:"left",label:"流程名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"processFullName",sortable:"custom",align:"left",label:"流程路径"}}),e._v(" "),s("el-table-column",{attrs:{prop:"processTotalCnt",sortable:"custom",label:"处理实例数"}}),e._v(" "),s("el-table-column",{attrs:{prop:"returnCnt",sortable:"custom",label:"退回实例数"}}),e._v(" "),s("el-table-column",{attrs:{prop:"returnRate",sortable:"custom",label:"退回率",width:"200"}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.imgLoading,expression:"!imgLoading"}],attrs:{slot:"empty"},slot:"empty"},[s("p",{style:{marginTop:"23px"}},[e._v("暂无数据")])]),e._v(" "),s("div",{attrs:{slot:"append"},slot:"append"},[s("page",{attrs:{pageIndex:e.pageIndex,total:e.model.selectForm.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1)],1)],1)]),e._v(" "),e.showdialog?s(e.componentParam.componentType,{tag:"component",attrs:{componentParam:e.componentParam},on:{hideComponent:e.hideComponent,sureSubmit:e.showMsgfromchild}}):e._e()],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")(C,b,!1,function(e){s("yLL/")},"data-v-7d738cb4",null);t.default=_.exports},"yLL/":function(e,t){}});
//# sourceMappingURL=18.e14f41849a1c1e384b83.js.map