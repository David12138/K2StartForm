webpackJsonp([26],{Ebz3:function(e,t){},Q9Y9:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("BO1k"),o=s.n(a),r=s("woOf"),i=s.n(r),n=s("Dd8w"),l=s.n(n),c=s("NYxO"),p=s("PJh5"),m=s.n(p),d=s("Lxn6"),u=s("T//Y"),f=s("8IKV"),h=s("J9uR"),g=s("Xg7m"),v=s("+vjY"),y={name:"processInstance",components:{CascaderOrganize:f.a,processClassification:g.a,processSelection:h.a,page:u.a},computed:l()({bodyHeight:function(){return document.documentElement.clientHeight}},Object(c.b)(["isIE","bodyHeight"])),data:function(){var e=this;return{pickerOptionsBefore:{disabledDate:function(t){var s=e.processform.date[1];if(s)return m()(t).format("YYYY-MM-DD")>s}},pickerOptionsAfter:{disabledDate:function(t){var s=e.processform.date[0];if(s)return m()(t).format("YYYY-MM-DD")<s}},tableData:[],processFormName:"",processCategoryName:"",processCategoryIDs:"",processName:"",processIDs:"",loading:!1,defaultFirst:["organize"],processform:{organize:{},department:{},projects:{},approveTime:"",date:[m()().subtract(1,"months").format("YYYY-MM-DD"),m()().format("YYYY-MM-DD")],processCategoryList:[],processList:[]},model:{companyID:"",startDateFrom:"",startDateTo:"",departmentID:"",projectID:"",processCategoryIDs:"",processID:"",orderBy:""},showdialog:!1,componentParam:{componentType:{type:String,required:!0},backfillData:{type:Array,required:!0},oneCheck:{type:Boolean,required:!0},closeShow:{type:Boolean,required:!0}},pageIndex:1,total:0,pageSize:20,pageSizesList:[20,50,100]}},mounted:function(){},methods:{formatMinutes:function(e){var t=parseInt(Math.floor(e/1440)),s=t>0?Math.floor((e-1440*t)/60):Math.floor(e/60),a=s>0?Math.floor(e-1440*t-60*s):e,o="";return t>0&&(o+=t+"天"),s>0&&(o+=s+"小时"),a>0&&(o+=a+"分钟"),o},sortChange:function(e){var t="statusName"==e.prop?"dodoType":e.prop;this.model.orderBy=t+" "+e.order.replace("ending",""),this.pageIndex=1,this.getResultList()},hideDate:function(e){setTimeout(function(){var t=void 0,s=void 0,a=null,o=null;document.getElementsByClassName("el-picker-panel")[0]&&(a=!0),document.getElementsByClassName("el-picker-panel")[1]&&(o=!0),t=a?document.getElementsByClassName("el-picker-panel")[0]:"",s=o?document.getElementsByClassName("el-picker-panel")[1]:"",e.$el.firstElementChild==document.activeElement?(a&&(t.style.display="none"),o&&(s.style.display="none")):(a&&(t.style.display="block"),o&&(s.style.display="block"))},10)},checknum:function(e){var t=this;/^([1-9]\d{0,9}|0)([.]?|(\.\d{1,2})?)$/.test(e)||setTimeout(function(){t.processform.approveTime=""},100)},handleSizeChange:function(e){this.pageIndex=1,this.pageSize=parseInt(e),localStorage.myInitPageSize=e,this.getResultList()},handleCurrentChange:function(e){this.pageIndex=e,this.getResultList()},changeSetvaule:function(e){this.processform=i()({},this.processform,e.data)},tableHeaderClassName:function(e){e.row,e.rowIndex;return"table-head-th"},openDailog:function(e){this.componentParam.closeShow=!1,this.componentParam.componentType=e,this.componentParam.oneCheck=!1,"processClassification"==e?this.componentParam.backfillData=this.processform.processCategoryList:"processSelection"==e&&(this.componentParam.backfillData=this.processform.processList),this.showdialog=!0,d.a.showDailog_mask()},hideComponent:function(){this.showdialog=!1,d.a.hiddenDailog_mask()},showMsgfromchild:function(e){e.type&&"processClassification"==e.type?(this.processform.processCategoryList=e.list,this.handleProcessCategory()):e.type&&"processSelection"==e.type&&(this.processform.processList=e.list,this.handleProcess()),this.hideComponent()},search:function(){this.getResultList()},refresh:function(){this.processform={organize:{},department:{},projects:{},date:[m()().subtract(1,"months").format("YYYY-MM-DD"),m()().format("YYYY-MM-DD")],processCategoryList:[],processList:[],approveTime:""},this.$refs.cascaderOrganize.$emit("refresh")},exportList:function(){var e=this;""!=e.model.processID||""!=e.model.processCategoryIDs?""!=e.processform.approveTime?e.processform.approveTime>1e4?e.$message.warning("审批时间超过N小时必须为小于10000数字！"):(v.a.startLoading({lock:!0,text:"加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")}),e.$axios.post("/api/exportExcelForTable",{tableName:"用户平均审批时间",params:e.model},{responseType:"blob"}).then(function(e){var t=e.data;d.a.exportSearchList("用户平均审批时间",t),v.a.endLoading()}).catch(function(t){v.a.endLoading(),e.$message.error("导出Excel失败!ERROR MESSAGE:"+t)})):e.$message.warning("审批时间超过N小时不能为空！"):e.$message.warning("请选择流程分类或流程!")},Quvalidation:function(){},getResultList:function(){var e=this;""!==e.model.companyID?""!=e.model.processID||""!=e.model.processCategoryIDs?this.model.startDateFrom&&this.model.startDateTo?""!=e.processform.approveTime?e.processform.approveTime>1e4?e.$message.warning("审批时间超过N小时必须为小于10000数字!"):""===e.model.startDateFrom&&""===e.model.startDateTo||!(e.model.startDateFrom<"1753-01-01"||e.model.startDateTo<"1753-01-01")?(v.a.startLoading(),e.$axios.post("/api/ApproveTime/page?pageIndex="+(e.pageIndex-1)+"&pageSize="+e.pageSize,this.model).then(function(t){v.a.endLoading(),200===t.status?(console.log(t.data),e.tableData=t.data.approveTimeList,e.total=t.data.pageControllerInfo.totalRecordCount):e.$message.error("请求失败！")}).catch(function(t){v.a.endLoading(),e.$message.error("查询列表数据失败!ERROR MESSAGE:"+t)})):this.$message.warning("请选择1753-01-01 ~ 9999-12-31之间的日期"):e.$message.warning("审批时间超过N小时不能为空!"):this.$message.warning("请选择日期!"):e.$message.warning("请选择流程分类或流程!"):e.$message.warning("请选择所属公司!")},handleProcess:function(){var e=[],t=[],s=!0,a=!1,r=void 0;try{for(var i,n=o()(this.processform.processList);!(s=(i=n.next()).done);s=!0){var l=i.value;t.push(l.name),e.push(l.processId+"")}}catch(e){a=!0,r=e}finally{try{!s&&n.return&&n.return()}finally{if(a)throw r}}return this.processName=t.join("；"),this.processIDs=e.join(","),e.join(",")||""},handleProcessCategory:function(){var e=[],t=[],s=!0,a=!1,r=void 0;try{for(var i,n=o()(this.processform.processCategoryList);!(s=(i=n.next()).done);s=!0){var l=i.value;t.push(l.name),e.push(l.id+"")}}catch(e){a=!0,r=e}finally{try{!s&&n.return&&n.return()}finally{if(a)throw r}}return this.processCategoryName=t.join("；"),this.processCategoryIDs=e.join(","),e.join(",")||""},handleQueryParam:function(e){this.model={companyID:e.organize.orgID||"",startDateFrom:e.date[0],startDateTo:e.date[1],departmentID:e.department.id||"",projectID:e.projects.pc_ID||"",processCategoryIDs:this.handleProcessCategory(),processID:this.handleProcess(),approveTime:e.approveTime}}},watch:{processform:{handler:function(e,t){this.handleQueryParam(e)},deep:!0}}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"staticReports todoProcess loadingtext"},[s("el-container",[s("el-header",[s("div",{staticClass:"staticReports minWidth"},[s("div",{staticClass:"taticReports-content"},[s("el-row",{staticClass:" staticReports-header ",attrs:{type:"flex",justify:"space-between"}},[s("el-col",{staticClass:"titleMT",attrs:{span:17}},[s("span",{staticClass:"mz",on:{click:function(t){e.$router.back(-1)}}},[e._v("流程报表")]),s("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),s("el-col",{staticClass:"titleBtn clearfix",attrs:{span:6}},[s("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.refresh}},[e._v("重置")]),e._v(" "),s("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.search}},[e._v("搜索")])],1)],1)],1)])]),e._v(" "),s("el-main",[s("div",{staticClass:"mainContaint"},[s("div",{staticClass:"todoProcess-screenList screenList-box",class:{screenList_box_ie:e.isIE}},[s("el-row",[s("el-col",{staticClass:"report",attrs:{span:24}},[s("span",[e._v("用户平均审批时间")])])],1),e._v(" "),s("el-form",{ref:"processform",staticClass:"todoForm",attrs:{"label-width":"100px",size:"mini"},model:{value:e.processform,callback:function(t){e.processform=t},expression:"processform"}},[s("el-row",{attrs:{type:""}},[s("CascaderOrganize",{ref:"cascaderOrganize",attrs:{isShowStar:!0,defaultFirst:e.defaultFirst},on:{changeSetvaule:e.changeSetvaule}})],1),e._v(" "),s("el-row",{attrs:{type:""}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"发起时段"}},[s("span",{staticStyle:{color:"red","font-size":"14px",float:"left",position:"absolute",top:"0",left:"-10px"}},[e._v("*")]),e._v(" "),s("div",{staticClass:"money-box"},[s("el-form-item",[s("el-date-picker",{staticClass:"todoDate",attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:!1,"picker-options":e.pickerOptionsBefore,placeholder:"选择日期"},on:{focus:e.hideDate},model:{value:e.processform.date[0],callback:function(t){e.$set(e.processform.date,0,t)},expression:"processform.date[0]"}})],1),e._v(" "),s("el-form-item",[e._v("~")]),e._v(" "),s("el-form-item",[s("el-date-picker",{staticClass:"todoDate",staticStyle:{float:"right"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:!1,"picker-options":e.pickerOptionsAfter,placeholder:"选择日期"},on:{focus:e.hideDate},model:{value:e.processform.date[1],callback:function(t){e.$set(e.processform.date,1,t)},expression:"processform.date[1]"}})],1)],1)])],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"流程分类"}},[s("span",{on:{dblclick:function(t){e.openDailog("processClassification")}}},[s("el-input",{staticClass:"input-text",attrs:{disabled:"",placeholder:"请选择...",title:e.processCategoryName},model:{value:e.processCategoryName,callback:function(t){e.processCategoryName=t},expression:"processCategoryName"}})],1),e._v(" "),s("i",{staticClass:"iconfont icon-category ",on:{click:function(t){e.openDailog("processClassification")}}})])],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"流程"}},[s("span",{on:{dblclick:function(t){e.openDailog("processSelection")}}},[s("el-input",{staticClass:"input-text",attrs:{disabled:"",placeholder:"请选择...",title:e.processName},model:{value:e.processName,callback:function(t){e.processName=t},expression:"processName"}})],1),e._v(" "),s("i",{staticClass:"iconfont icon-category ",on:{click:function(t){e.openDailog("processSelection")}}})])],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"审批超过"}},[s("span",{staticStyle:{color:"red","font-size":"14px",float:"left",position:"absolute",top:"0",left:"-10px"}},[e._v("*")]),e._v(" "),s("span",{staticClass:"clearfix"},[s("el-input",{staticClass:"hours input-embedded input-text",attrs:{type:"text"},on:{input:function(t){e.checknum(e.processform.approveTime)}},model:{value:e.processform.approveTime,callback:function(t){e.$set(e.processform,"approveTime",t)},expression:"processform.approveTime"}}),e._v(" "),s("i",{staticClass:"text-embedded"},[e._v("小时")])],1)])],1)],1)],1),e._v(" "),s("div",{staticClass:"todoProcess-main"},[s("el-row",{staticClass:"listButton",attrs:{type:"flex",justify:"end"}},[s("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",icon:"iconfont icon-export",size:"mini"},on:{click:e.exportList}},[e._v("导出\n              ")])],1),e._v(" "),s("div",{staticClass:"list"},[s("el-table",{ref:"singleTable",attrs:{data:e.tableData,height:e.bodyHeight-400,"header-row-class-name":e.tableHeaderClassName,border:"","highlight-current-row":"",size:"mini"},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{property:"userID",label:"审批人账号",width:"130",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.userID}},[e._v(e._s(t.row.userID))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"userName",label:"审批人","min-width":"130",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.userName}},[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"departmentName","min-width":"130",label:"部门名称",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.departmentName}},[e._v(e._s(t.row.departmentName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"numer",width:"130",label:"审批次数",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.numer}},[e._v(e._s(t.row.numer))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"totaltime",width:"130",label:"审批时长",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.total}},[e._v(e._s(t.row.total))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"totaltime",width:"130",label:"平均审批时长",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.avgTIME}},[e._v(e._s(t.row.avgTIME))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"processIDList",width:"100",label:"流程ID",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.processIDList}},[e._v(e._s(t.row.processIDList))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"activityNameList",width:"100",label:"审批步骤",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.activityNameList}},[e._v(e._s(t.row.activityNameList))])]}}])}),e._v(" "),s("div",{attrs:{slot:"empty"},slot:"empty"},[s("p",[e._v("暂无数据")])]),e._v(" "),s("div",{attrs:{slot:"append"},slot:"append"},[e.tableData.length>0?s("page",{attrs:{pageIndex:e.pageIndex,total:e.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}):e._e()],1)],1)],1)],1)],1)]),e._v(" "),e.showdialog?s(e.componentParam.componentType,{tag:"component",attrs:{componentParam:e.componentParam},on:{hideComponent:e.hideComponent,sureSubmit:e.showMsgfromchild}}):e._e()],1)],1)],1)},staticRenderFns:[]};var C=s("VU/8")(y,b,!1,function(e){s("Ebz3")},"data-v-29a5f2f2",null);t.default=C.exports}});
//# sourceMappingURL=26.c9a15bee442296344269.js.map