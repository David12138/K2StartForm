webpackJsonp([19],{EMQL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),o=a("NYxO"),n=(a("PJh5"),a("Lxn6")),l=a("Bwb9"),r=(a("+vjY"),{name:"draftProcess",components:{page:a("T//Y").a,flowchart_dialog:l.a},mounted:function(){var e=this;n.a.burialPoint("流程草稿-进入流程草稿页面"),e.getList(),window.onmessage=function(t){"refreshNewSystem"===t.data.key&&e.getList()}},data:function(){return{model:{whereParams:{}},procInstIDs:[],comp:{},loading:!1,company:"",pageIndex:1,total:10,pageSize:10,pageSizesList:[10,20],draftList:[],showMess:!1,rowData:{},applyReason:"",multipleSelections:[],exportData:[],orderBy:"StartDate DESC",imgLoading:!1}},methods:{sortChange:function(e){n.a.burialPoint("流程草稿-列表-"+e.column.label+"排序"),this.orderBy=e.prop+" "+e.order.replace("ending",""),this.getList()},renderIcon:function(e,t){t.column;return e("i",{class:"iconfont icon-process"})},openDailog:function(e){this.comp.component=e,this.showdialog=!0,n.a.showDailog_mask()},hideComponent:function(){this.showdialog=!1,n.a.hiddenDailog_mask()},deleteList:function(){this.multipleSelections=this.multipleSelection,""==this.multipleSelection||void 0==this.multipleSelection?this.$message.warning("至少选中一条信息"):this.showMess=!0},correctmess:function(){var e=this,t=this;t.formIds=[];for(var a=0;a<t.multipleSelections.length;a++)t.formIds.push(t.multipleSelections[a].FormId);t.$axios.post("Portal/WorkFlow/DeleteDraft",t.formIds).then(function(a){200==a.data.code?(t.showMess=!1,t.$message({type:"success",message:"删除流程成功!"}),t.$refs.multipleTable.clearSelection(),t.getList()):(t.showMess=!1,t.$message.warning(e.FormId+"删除流程失败!"),t.$refs.multipleTable.clearSelection())}).catch(function(e){t.$message.error("审批失败!ERROR MESSAGE:"+e.response.data.message)})},cancelmess:function(){this.showMess=!1,this.$refs.multipleTable.clearSelection()},search:function(){this.pageIndex=1,this.getList()},getList:function(){var e=this;e.imgLoading=!1;var t={pageSize:this.pageSize,pageIndex:this.pageIndex,orderBy:this.orderBy};e.$axios({url:"/Portal/WorkFlow/GetMyDrafts",method:"post",data:t}).then(function(t){200===t.data.code?(e.draftList=t.data.data.item,e.total=t.data.data.total):e.$message.error("请求失败！")}).catch(function(t){e.imgLoading=!1,e.$message.error("审批失败!ERROR MESSAGE:"+t.response.data.message)})},rowClick:function(e,t,a){a.hasOwnProperty("label")&&""===a.label&&(this.rowData=e,this.openDailog("flowchart_dialog"))},handleSizeChange:function(e){n.a.burialPoint("流程草稿-列表-每页显示条数按钮");var t=""+e;this.pageIndex=1,this.pageSize=parseInt(t),localStorage.draftPageSize=e,this.getList()},handleCurrentChange:function(e){n.a.burialPoint("流程草稿-列表-页码按钮"),this.pageIndex=e,this.getList()},tableHeaderClassName:function(e){e.row,e.rowIndex;return"table-head-th"},handleSelectionChange:function(e){this.multipleSelection=e},folioBlank:function(e){window.open(e.Url,"_blank")}},computed:i()({bodyHeight:function(){return document.documentElement.clientHeight}},Object(o.b)(["count","isSafari","bodyHeight"]))}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"draftProcess todoProcess loadingtext",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("el-container",[a("el-header",[a("div",{staticClass:"top-header"},[a("span",{staticClass:"top-breadCrumb"},[e._v("流程草稿")]),e._v(" "),a("div",{staticClass:"searchCom"})])]),e._v(" "),a("el-main",[a("div",{staticClass:"mainContaint"},[e.showMess?a("el-dialog",{staticClass:"message-dialog",attrs:{visible:e.showMess,id:"delProcess",title:"申请删除草稿","close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(t){e.showMess=t}}},[a("span",{staticClass:"dialog-bodys"},[e._v("您确认需要删除所选草稿吗？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check-outline",size:"mini"},on:{click:e.correctmess}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-circle-close-outline",size:"mini"},on:{click:e.cancelmess}},[e._v("取 消")])],1)]):e._e(),e._v(" "),a("div",{staticClass:"draftProcess-main"},[a("el-row",{staticClass:"listButton",attrs:{type:"flex",justify:"end"}},[a("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",icon:"el-icon-delete",size:"mini"},on:{click:e.deleteList}},[e._v("删除草稿\n          ")])],1),e._v(" "),a("div",{staticClass:"list",class:{table_safari:e.isSafari}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","font-size":"14px"},attrs:{height:e.bodyHeight-253,data:e.draftList,border:"","header-row-class-name":e.tableHeaderClassName,size:"mini"},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange,"row-click":e.rowClick}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ProcessName",align:"center",label:"流程名称","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{attrs:{title:t.row.ProcessName}},[e._v(e._s(t.row.ProcessName))])]}}])}),e._v(" "),a("el-table-column",{staticClass:"table-folio",attrs:{prop:"FormSubject",label:"流程主题",align:"center","min-width":"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover folio",on:{click:function(a){e.folioBlank(t.row)}}},[e._v(e._s(t.row.FormSubject))]),e._v(" "),a("el-tooltip",{attrs:{placement:"right",disabled:!t.row.Summary,color:"rgb(166, 176, 185)",effect:"light"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"toolTipContent"},[a("div",[e._v(e._s(t.row.Summary))])])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"SaveDate",width:"150px",label:"保存时间",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("moment")(t.row.SubmitDate,"YYYY-MM-DD HH:mm")))]}}])}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.imgLoading,expression:"!imgLoading"}],attrs:{slot:"empty"},slot:"empty"},[a("p",{style:{marginTop:"23px"}},[e._v("暂无数据")])]),e._v(" "),a("div",{attrs:{slot:"append"},slot:"append"},[e.draftList.length>0?a("page",{attrs:{pageIndex:e.pageIndex,total:e.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}):e._e()],1)],1)],1)],1)],1)])],1)],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(e){a("hEOd")},"data-v-6fada695",null);t.default=d.exports},hEOd:function(e,t){}});
//# sourceMappingURL=19.53d0b50fadd5ae52eba6.js.map