webpackJsonp([20],{XAjd:function(e,t){},ZDEY:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("BO1k"),i=s.n(a),o=s("T//Y"),r=s("Lxn6"),l=s("ve2v"),n=s("ts/9"),c=s("nSyc"),h=s("+vjY"),d={name:"staticsJob",components:{page:o.a,originator_dailog:l.a,project_dialog:n.a,process_dialog:c.a},mounted:function(){},data:function(){return{fullHeight:document.documentElement.clientHeight,isShow:!0,queryName:"",multiplelimit:1,loading:!1,arrt:"收起",icon:"el-icon-arrow-up",isAvailable:!1,model:{selectForm:{userID:"",poisitionID:null,processIDs:"",processCategoryIDs:""},userName:[]},hintwring:"",hintwringShow:!1,tableData:[],orgStates:[],processList:[],pageSizesList:[10,20,50,100],pageIndex:1,pageSize:10,total:0,showdialog:!1,comp:{},exportData:[],oneCheck:!0,orderBy:"",checked:"1",childDataUrl:{url:"",selectedPerson:[],chooseProject:{}},imgLoading:!1}},methods:{emptyselect:function(){this.childDataUrl.selectedPerson=[],this.model.userName=[]},isChange:function(e){this.isAvailable=e,this.isAvailable?this.checked="":this.checked="1"},showToggle:function(){this.isShow=!this.isShow,this.isShow?(this.arrt="收起",this.icon="el-icon-arrow-up"):(this.arrt="展开",this.icon="el-icon-arrow-down")},sortChange:function(e){this.orderBy=("isAvailabletype"==e.prop?"isAvailable":e.prop)+" "+e.order.replace("ending",""),0!==this.model.userName.length&&this.getList()},search:function(){this.pageIndex=1,this.getList()},handleSizeChange:function(e){var t=""+e;this.pageIndex=1,this.pageSize=parseInt(t),localStorage.checkPageSize=e,this.getList()},handleCurrentChange:function(e){this.pageIndex=e,this.getList()},getList:function(){var e=this;this.imgLoading=!0,this.model.selectForm.orderBy=this.orderBy,this.model.selectForm.isAvailable=this.checked,this.model.selectForm.pageSize=this.pageSize,this.model.selectForm.pageIndex=this.pageIndex-1,localStorage.todoPageSize&&(this.pageSize=Number(localStorage.todoPageSize));var t="";this.model.selectForm.userID="";var s=!0,a=!1,o=void 0;try{for(var r,l=i()(this.childDataUrl.selectedPerson);!(s=(r=l.next()).done);s=!0){t+="VANKE\\"+r.value.userId+";"}}catch(e){a=!0,o=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw o}}t&&(this.model.selectForm.userID=t.substring(0,t.length-1)),this.$axios.post("/api/reportForm/peopleApprovedProcesses",this.model.selectForm).then(function(t){e.tableData=t.data.processList,e.total=t.data.listCounts;for(var s=0;s<t.data.processList.length;s++)switch(Number(t.data.processList[s].isAvailable)){case 0:t.data.processList[s].isAvailabletype="否";break;case 1:t.data.processList[s].isAvailabletype="是";break;default:t.data.processList[s].isAvailabletype="否"}e.imgLoading=!1}).catch(function(t){e.imgLoading=!1,e.$message.error("查询列表数据失败!ERROR MESSAGE:"+t)})},inquire:function(){this.pageIndex=1,0==this.model.userName.length?this.$message.warning("请选择账号!"):this.getList()},refresh:function(){var e=this;this.model.selectForm.searchWord="",this.model.selectForm.companys="",this.isAvailable="",this.checked="",this.$nextTick(function(){e.model.selectForm.userID="",e.model.userName=[],e.model.processFullName="",e.model.Date=[],e.childDataUrl.selectedPerson=[]})},toTree:function(e){if(null==e||0==e.length)return[];e.forEach(function(e){delete e.children});var t={};e.forEach(function(e){t[e.id]=e});var s=[];return e.forEach(function(e){var a=t[e.pid];a?(a.children||(a.children=[])).push(e):s.push(e)}),s},exportList:function(){var e=this;h.a.startLoading({lock:!0,text:"数据量过大，正在拼命加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")});var t={params:{pageIndex:0,pageSize:this.total,orderBy:this.orderBy,isAvailable:this.checked,userID:this.model.selectForm.userID,processIDs:"",processCategoryIDs:"",poisitionID:null},tableName:"静态统计某个岗位参与的流程"};this.$axios.post("/api/exportExcelForTable",t,{responseType:"blob"}).then(function(e){h.a.endLoading();var t=e.data;r.a.exportSearchList("静态统计某个岗位参与的流程",t)}).catch(function(t){h.a.endLoading(),e.$message.error("导出失败!ERROR MESSAGE:"+t)})},getUsers:function(e){var t=this,s=this;s.orgStates=[],s.$axios.post("/api/getUser",{name:e,deptId:"",isWork:"1"}).then(function(e){for(var a=0;a<e.data.result.length;a++)s.orgStates.push({value:e.data.result[a].displayName,userId:e.data.result[a].adAccount,orgFullPath:e.data.result[a].companyName+"-"+e.data.result[a].orgNameFullPath,vankeId:e.data.result[a].vankeId});t.loading=!1}).catch(function(e){s.$message.error("查询列表数据失败!ERROR MESSAGE:"+e)})},querySearchUser:function(e){if(this.orgStates=[],this.queryName=e,0==this.model.userName.length){this.hintwring="",this.hintwringShow=!1;var t=this;if(this.loading=!0,this.isSeach)return;this.isSeach=!0,setTimeout(function(){t.isSeach=!1,t.validationInput(t.queryName)},2e3)}else""==e.trim()?(this.hintwringShow=!1,this.hintwring=""):(this.hintwringShow=!0,this.hintwring="注意：此处账号选择只能单选！")},personChange:function(e){this.$set(this.$refs.userId,"query",""),this.childDataUrl.selectedPerson[0]=e},removeUser:function(e){if(e.userId){for(var t=0;t<this.childDataUrl.selectedPerson.length&&e.userId!=this.childDataUrl.selectedPerson[t].userId;t++);this.childDataUrl.selectedPerson.splice(t,1)}else{for(t=0;t<this.childDataUrl.selectedPerson.length&&e!=this.childDataUrl.selectedPerson[t].value;t++);this.childDataUrl.selectedPerson.splice(t,1)}},validationInput:function(e){if(""==e||0==e.length)return this.loading=!1,null;e==this.$refs.userId.query?this.getUsers(e):this.orgStates=[]},visibleChange:function(e){this.orgStates=[],e||(this.hintwringShow=!1,this.hintwring="")},clearUser:function(){this.childDataUrl.selectedPerson=[]},openDialog:function(e,t){this.comp.component=e,this.showdialog=!0,r.a.showDailog_mask(),"originator_dailog"==e?(this.oneCheck=!0,this.childDataUrl.getTree="getTree",this.childDataUrl.companytree="companytree/page"):"project_dialog"==e&&(this.childDataUrl.getTree="getTree",this.childDataUrl.companytree="companytree/page")},showMsgfromchild:function(e){if(e.type&&"project"==e.type)if(this.oneCheck){var t=e.last.lastNode;this.model.companys_t=t,this.model.companys=t,this.model.companys.length>15&&(this.model.companys=this.model.companys.substr(0,20)+"..."),this.model.selectForm.departmentID=e.item.orgID,this.model.selectForm.companyCode=e.last.lastId.toString()}else e.items;else if(e.type&&"process"==e.type)this.processFormName=e.text,this.model.selectForm.processID=e.processID;else if(e.type&&"originator"==e.type){this.childDataUrl.selectedPerson=[],this.model.userName=[];var s=!0,a=!1,o=void 0;try{for(var r,l=i()(e.peoArr);!(s=(r=l.next()).done);s=!0){for(var n=r.value,c=n.userId,h=n.vankeId,d=!1,p=0;p<this.childDataUrl.selectedPerson.length;p++)this.childDataUrl.selectedPerson[p].userId===c&&(d=!0);d||(this.childDataUrl.selectedPerson.push({userId:c,value:n.name,vankeId:h}),this.model.userName.push(n.name))}}catch(e){a=!0,o=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw o}}}this.hideComponent()},hideComponent:function(){this.showdialog=!1,r.a.hiddenDailog_mask()}},watch:{fullHeight:function(){return document.documentElement.clientHeight}},computed:{}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"staticReports"},[s("el-container",[s("el-header",{staticClass:"minWidth"},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"staticReports minWidth loadingtext",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[s("el-row",{staticClass:"staticReports-header"},[s("el-col",{attrs:{span:17}},[s("span",{staticClass:"mz",on:{click:function(t){e.$router.back(-1)}}},[e._v("流程报表")]),e._v(" "),s("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),s("el-col",{staticClass:"statisticjobbtns",attrs:{span:7}},[s("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:e.inquire}},[e._v("查询\n            ")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:e.refresh}},[e._v("重置\n            ")])],1)],1),e._v(" "),s("div",{staticClass:"taticReports-content"},[e.isShow?s("div",{staticClass:"statement "},[s("el-row",{staticStyle:{"margin-bottom":"10px"}},[s("el-col",{attrs:{span:24}},[s("span",[e._v("静态-统计某个人员参与的流程报表")])])],1),e._v(" "),s("el-row",{staticClass:"staticReports-middle"},[s("el-col",{staticStyle:{"min-width":"78px"},attrs:{sm:4,md:1}},[s("span",[e._v("账号选择")])]),e._v(" "),s("el-col",{staticClass:"accountchiose",attrs:{span:7}},[s("span",{on:{dblclick:function(t){e.openDialog("originator_dailog")}}},[s("i",{staticClass:"iconfont icon-member",on:{click:function(t){e.openDialog("originator_dailog")}}}),e._v(" "),s("el-select",{ref:"userId",attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"","popper-class":"orgstates","remote-method":e.querySearchUser,"value-key":"userId",loading:e.loading},on:{clear:e.emptyselect,change:e.personChange,"remove-tag":e.removeUser,"visible-change":e.visibleChange},model:{value:e.model.userName[0],callback:function(t){e.$set(e.model.userName,0,t)},expression:"model.userName[0]"}},e._l(e.orgStates,function(t,a){return s("el-option",{key:a,attrs:{label:t.value,value:t}},[s("div",{staticClass:"userheight"},[e._v(e._s(t.value)+"("+e._s(t.userId)+")")]),e._v(" "),s("div",{staticClass:"fullpathsize"},[e._v(e._s(t.orgFullPath))])])}))],1)]),e._v(" "),s("el-col",{attrs:{span:5}},[s("i",{class:[e.hintwringShow?"el-icon-warning":""]}),s("span",[e._v(e._s(e.hintwring))])]),e._v(" "),s("el-col",{attrs:{span:3}},[s("el-checkbox",{on:{change:e.isChange},model:{value:e.isAvailable,callback:function(t){e.isAvailable=t},expression:"isAvailable"}},[e._v("包含无效流程")])],1)],1),e._v(" "),s("el-row",[s("el-col",{staticStyle:{"text-align":"right",float:"right"},attrs:{span:24}},[s("el-button",{staticClass:"upload",attrs:{type:"primary",round:"",icon:"iconfont icon-export",size:"mini"},on:{click:e.exportList}},[e._v("导出\n                ")])],1)],1)],1):e._e()]),e._v(" "),s("div",{staticClass:"taticReports-content"},[s("div",{staticClass:"statement"},[s("el-table",{ref:"singleTable",staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{data:e.tableData,border:"","highlight-current-row":"",height:e.isShow?e.fullHeight-305:e.fullHeight-317},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{prop:"orgName",sortable:"custom",label:"公司"}}),e._v(" "),s("el-table-column",{attrs:{prop:"processFullName",label:"目录",align:"left",sortable:"custom","min-width":"155"}}),e._v(" "),s("el-table-column",{attrs:{prop:"processID","min-width":"50",sortable:"custom",label:"ID"}}),e._v(" "),s("el-table-column",{attrs:{prop:"processName","min-with":"180px",sortable:"custom",label:"流程名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"templeName",sortable:"custom",label:"模板名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"stepInfos","min-width":"150",align:"left",sortable:"custom",label:"步骤信息"}}),e._v(" "),s("el-table-column",{attrs:{prop:"processCCUser","min-width":"100",sortable:"custom",label:"抄送人"}}),e._v(" "),s("el-table-column",{attrs:{prop:"isAvailabletype",sortable:"custom",label:"是否有效"}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.imgLoading,expression:"!imgLoading"}],attrs:{slot:"empty"},slot:"empty"},[s("p",{style:{marginTop:"23px"}},[e._v("暂无数据")])]),e._v(" "),s("div",{attrs:{slot:"append"},slot:"append"},[s("page",{attrs:{pageIndex:e.pageIndex,total:e.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1)],1)])],1),e._v(" "),e.showdialog?s(e.comp.component,{tag:"component",attrs:{oneCheck:e.oneCheck,childDataUrl:e.childDataUrl,queryName:e.queryName},on:{hideComponent:e.hideComponent,sureSubmit:e.showMsgfromchild}}):e._e()],1)],1)],1)},staticRenderFns:[]};var m=s("VU/8")(d,p,!1,function(e){s("XAjd")},"data-v-6403dd61",null);t.default=m.exports}});
//# sourceMappingURL=20.af792be1d20c81514ff2.js.map