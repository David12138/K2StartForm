webpackJsonp([25],{kpkJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),o=a.n(i),n=a("NYxO"),s=a("Lxn6"),l=(a("PJh5"),a("+vjY")),r={name:"authorized",components:{page:a("T//Y").a},mounted:function(){s.a.burialPoint("授权设置-进入授权设置页面"),this.selectForm.fromUserID=s.a.getLocalStorage("loginname"),this.getList()},data:function(){return{pageIndex:1,total:0,pageSize:20,pageSizesList:[20,50,100],multipleSelection:[],deleteMsg:!1,tableData:[],selectForm:{fullUserID:localStorage.getItem("loginname"),recType:0,orderBy:"processDelegateID desc"},imgLoading:!1}},methods:{formatter:function(e){switch(e.recType){case 1:e.recName="授权处理";break;case 2:e.recName="授权查看"}return e},sortChange:function(e){this.selectForm.orderBy=("recName"==e.prop?"recType":e.prop)+" "+e.order.replace("ending",""),this.getList()},deleteConfirm:function(){var e=this;this.deleteMsg=!1,e.$axios.post("/api/deleteUserAuthority",{lotNumber:this.multipleSelection[0].lotNumber}).then(function(t){e.$message({type:"success",message:"取消授权成功!"}),e.getList()}).catch(function(t){e.$message.error("取消授权失败!ERROR MESSAGE:"+t)})},cancleConfirm:function(){this.deleteMsg=!1,this.$refs.multipleTable.clearSelection()},handelAdd:function(){s.a.burialPoint("授权设置-操作按钮-增加"),this.$router.push({path:"/authorizedStyle"})},handleEdit:function(){s.a.burialPoint("授权设置-操作按钮-编辑");var e;e=this.multipleSelection[0],this.$router.push({path:"/authorizedStyle",query:{params:{lotNumber:e.lotNumber,recType:e.recType}}})},btnDelete:function(){s.a.burialPoint("授权设置-操作按钮-取消授权"),this.deleteMsg=!0},getList:function(){var e=this;this.imgLoading=!0;var t=this;localStorage.authPageSize&&(t.pageSize=Number(localStorage.authPageSize)),t.$axios.post("/api/getUserAuthorityPage?pageIndex="+(t.pageIndex-1)+"&pageSize="+t.pageSize,t.selectForm).then(function(a){if(t.total=a.data.pageControllerInfo.totalRecordCount,0!=a.data.userAuthorityList.length)for(var i=0;i<a.data.userAuthorityList.length;i++)a.data.userAuthorityList[i]=e.formatter(a.data.userAuthorityList[i]);t.tableData=a.data.userAuthorityList,e.imgLoading=!1}).catch(function(a){e.imgLoading=!1,t.$message.error("查询列表数据失败!ERROR MESSAGE:"+a)})},handleSizeChange:function(e){var t=e;this.pageIndex=1,this.pageSize=parseInt(t),localStorage.authPageSize=e,this.getList()},handleCurrentChange:function(e){this.pageIndex=e,this.getList()},tableHeaderClassName:function(e){e.row,e.rowIndex;return"table-head-th"},handleSelectionChange:function(e){this.multipleSelection=e},exportList:function(){var e=this;s.a.burialPoint("授权设置-操作按钮-导出"),l.a.startLoading({lock:!0,text:"数据量过大，正在拼命加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")});var t={tableName:"授权设置",params:this.selectForm};this.$axios.post("/api/exportExcelForTable",t,{responseType:"blob"}).then(function(e){var t=e.data;s.a.exportSearchList("授权设置列表",t),l.a.endLoading()}).catch(function(t){l.a.endLoading(),e.$message.error("导出Excel失败!ERROR MESSAGE:"+t)})}},computed:o()({bodyHeight:function(){return document.documentElement.clientHeight}},Object(n.b)(["isSafari","bodyHeight"]))},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"authorized  todoProcess loadingtext",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("el-container",[a("el-header",[a("div",{staticClass:"top-header"},[a("span",{staticClass:"top-breadCrumb"},[e._v("授权设置")])])]),e._v(" "),a("el-main",[a("div",{staticClass:"mainContaint"},[e.deleteMsg?a("el-dialog",{staticClass:"message-dialog",attrs:{visible:e.deleteMsg,title:"编辑","close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(t){e.deleteMsg=t}}},[a("span",{staticStyle:{"text-align":"left"}},[e._v("您确认要取消授权？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check-outline",size:"mini"},on:{click:e.deleteConfirm}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-close-outline",size:"mini"},on:{click:e.cancleConfirm}},[e._v("取 消")])],1)]):e._e(),e._v(" "),a("div",{staticClass:"todoProcess-main"},[a("el-row",{staticClass:"listButton",attrs:{type:"flex",justify:"end"}},[a("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",icon:"iconfont icon-export",size:"mini"},on:{click:e.exportList}},[e._v("导出\n            ")]),e._v(" "),a("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.handelAdd}},[e._v("增加\n            ")]),e._v(" "),a("el-button",{staticClass:"upload",attrs:{disabled:1!=e.multipleSelection.length,round:"",type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:e.handleEdit}},[e._v("编辑\n            ")]),e._v(" "),a("el-button",{staticClass:"upload",attrs:{disabled:1!=e.multipleSelection.length,round:"",type:"primary",size:"mini",icon:"el-icon-close"},on:{click:e.btnDelete}},[e._v("取消授权\n            ")])],1),e._v(" "),a("div",{staticClass:"list",class:{table_safari:e.isSafari}},[a("el-table",{ref:"multipleTable",attrs:{height:e.bodyHeight-215,data:e.tableData,border:"","header-row-class-name":e.tableHeaderClassName,size:"mini"},on:{"selection-change":e.handleSelectionChange,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"selection",width:"42px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"recName","min-width":"25px",width:"76px",label:"类型",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.recName))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"fromUserName",label:"授权用户",align:"left",width:"180px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.fromUserName}},[e._v(e._s(t.row.fromUserName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"toUserName",label:"被授权用户",align:"left",width:"180px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.toUserName}},[e._v(e._s(t.row.toUserName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"beginTime",label:"开始日期",align:"left",width:"120px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.beginTime?a("span",[e._v(e._s(e._f("moment")(t.row.beginTime)))]):a("span",[e._v(e._s(t.row.beginTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"endTime",label:"终止日期",align:"left",width:"120px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.endTime?a("span",[e._v(e._s(e._f("moment")(t.row.endTime)))]):a("span",[e._v(e._s(t.row.endTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"processName",label:"授权流程",align:"left","min-width":"100px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.processName}},[e._v(e._s(t.row.processName))])]}}])}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.imgLoading,expression:"!imgLoading"}],attrs:{slot:"empty"},slot:"empty"},[a("p",{style:{marginTop:"23px"}},[e._v("暂无数据")])]),e._v(" "),a("div",{attrs:{slot:"append"},slot:"append"},[e.tableData.length>0?a("page",{attrs:{pageIndex:e.pageIndex,total:e.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}):e._e()],1)],1)],1)],1)],1)])],1)],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(e){a("lPWG")},"data-v-2f2f3348",null);t.default=d.exports},lPWG:function(e,t){}});
//# sourceMappingURL=25.302a50065ce5128d864a.js.map