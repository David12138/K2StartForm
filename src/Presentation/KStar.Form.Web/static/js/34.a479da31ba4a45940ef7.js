webpackJsonp([34],{cvSv:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),o=s.n(a),r=s("BO1k"),i=s.n(r),n=s("woOf"),l=s.n(n),c=s("NYxO"),p=s("T//Y"),d=s("+vjY"),m=s("PJh5"),u=s.n(m),f=s("Lxn6"),h=s("8IKV"),v=s("J9uR"),g=s("Xg7m"),y={name:"notFinished",components:{CascaderOrganize:h.a,processClassification:g.a,processSelection:v.a,page:p.a},data:function(){var e=this;return{pickerOptionsBefore:{disabledDate:function(t){var s=e.processform.date[1];if(s)return u()(t).format("YYYY-MM-DD")>s}},pickerOptionsAfter:{disabledDate:function(t){var s=e.processform.date[0];if(s)return u()(t).format("YYYY-MM-DD")<s}},icon:"el-icon-arrow-down",loading:!1,processFormName:"",processCategoryName:"",processCategoryIDs:"",processName:"",processIDs:"",defaultFirst:["organize"],processform:{organize:{},department:{},projects:{},date:[u()().subtract(1,"months").format("YYYY-MM-DD"),u()().format("YYYY-MM-DD")],numDay:"",processCategoryList:[],processList:[]},isShow:!0,arrt:"收起",model:{approveTime:"",url:"127.0.0.1",port:"3306",companyID:"",startDateFrom:"",startDateTo:"",departmentID:"",projectTD:"",processID:"",processCategoryIDs:"",beforeTheDate:""},tableData:[],oneCheck:!1,disabled:!1,childDataUrl:{url:"",selectedPerson:[]},showdialog:!1,componentParam:{componentType:{type:String,required:!0},backfillData:{type:Array,required:!0},oneCheck:{type:Boolean,required:!0},closeShow:{type:Boolean,required:!0}},pageIndex:1,total:0,pageSize:20,pageSizesList:[20,50,100]}},mounted:function(){},methods:{jumpToOld:function(e){if(f.a.browserIsIE()){var t=escape(e.viewUrl);window.open("oldIframe.html?viewurl="+t,"_blank")}else window.open(e.viewUrl)},sortChange:function(e){var t="statusName"==e.prop?"dodoType":e.prop;this.model.orderBy=t+" "+e.order.replace("ending",""),this.pageIndex=1,this.getResultList()},hideDate:function(e){setTimeout(function(){var t=void 0,s=void 0,a=null,o=null;document.getElementsByClassName("el-picker-panel")[0]&&(a=!0),document.getElementsByClassName("el-picker-panel")[1]&&(o=!0),t=a?document.getElementsByClassName("el-picker-panel")[0]:"",s=o?document.getElementsByClassName("el-picker-panel")[1]:"",e.$el.firstElementChild==document.activeElement?(a&&(t.style.display="none"),o&&(s.style.display="none")):(a&&(t.style.display="block"),o&&(s.style.display="block"))},10)},handleSizeChange:function(e){var t=""+e;this.pageIndex=1,this.pageSize=parseInt(t),localStorage.myInitPageSize=e,this.getResultList()},handleCurrentChange:function(e){this.pageIndex=e,this.getResultList()},changeSetvaule:function(e){this.processform=l()({},this.processform,e.data)},tableHeaderClassName:function(e){e.row,e.rowIndex;return"table-head-th"},openDailog:function(e){this.componentParam.closeShow=!1,this.componentParam.componentType=e,this.componentParam.oneCheck=!1,"processClassification"==e?this.componentParam.backfillData=this.processform.processCategoryList:"processSelection"==e&&(this.componentParam.backfillData=this.processform.processList),this.showdialog=!0,f.a.showDailog_mask()},hideComponent:function(){this.showdialog=!1,f.a.hiddenDailog_mask()},showMsgfromchild:function(e){e.type&&"processClassification"==e.type?(this.processform.processCategoryList=e.list,this.handleProcessCategory()):e.type&&"processSelection"==e.type&&(this.processform.processList=e.list,this.handleProcess()),this.hideComponent()},search:function(){this.pageIndex=1,this.getResultList()},refresh:function(){this.processform={organize:{},department:{},projects:{},date:[u()().subtract(1,"months").format("YYYY-MM-DD"),u()().format("YYYY-MM-DD")],processCategoryList:[],processList:[],numDay:""},this.$refs.cascaderOrganize.$emit("refresh")},exportList:function(){var e=this;this.modelValidate()||(d.a.startLoading({lock:!0,text:"加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")}),e.$axios.post("/api/exportExcelForTable",{tableName:"未结束流程列表",params:e.model},{responseType:"blob"}).then(function(e){var t=e.data;f.a.exportSearchList("未结束流程列表",t),d.a.endLoading()}).catch(function(t){d.a.endLoading(),e.$message.error("导出Excel失败!ERROR MESSAGE:"+t)}))},inputValidate:function(e){var t=this;/^([1-9]\d{0,9}|0)([.]?|(\.\d{1,2})?)$/.test(e)||setTimeout(function(){t.processform.numDay=""},100)},modelValidate:function(){return""==this.model.processID&&""==this.model.processCategoryIDs?(this.$message.warning("请选择流程分类或流程！"),!0):""==this.model.beforeTheDate?(this.$message.warning("超过N天结束，不能为空！"),!0):this.model.beforeTheDate>1e4&&(this.$message.warning("超过N天结束，必须为小于10000的数字。"),!0)},getResultList:function(){var e=this;console.log(this.model.companyID),""!==this.model.companyID?this.modelValidate()||(this.model.startDateFrom&&this.model.startDateTo?""===this.model.startDateFrom&&""===this.model.startDateTo||!(this.model.startDateFrom<"1753-01-01"||this.model.startDateTo<"1753-01-01")?(d.a.startLoading(),this.$axios.post("/api/UnfinishProcess/page?pageIndex="+(this.pageIndex-1)+"&pageSize="+this.pageSize,this.model).then(function(t){d.a.endLoading(),200===t.status?(e.tableData=t.data.unfinishProcessList,e.total=t.data.pageControllerInfo.totalRecordCount):(d.a.endLoading(),e.$message.error("请求失败！"))}).catch(function(t){d.a.endLoading(),e.$message.error("查询列表数据失败!ERROR MESSAGE:"+t)})):this.$message.warning("请选择1753-01-01 ~ 9999-12-31之间的日期"):this.$message.warning("请选择日期")):this.$message.warning("请选择所属公司")},handleProcess:function(){var e=[],t=[],s=!0,a=!1,o=void 0;try{for(var r,n=i()(this.processform.processList);!(s=(r=n.next()).done);s=!0){var l=r.value;t.push(l.name),e.push(l.processId+"")}}catch(e){a=!0,o=e}finally{try{!s&&n.return&&n.return()}finally{if(a)throw o}}return this.processName=t.join("；"),this.processIDs=e.join(","),e.join(",")||""},handleProcessCategory:function(){var e=[],t=[],s=!0,a=!1,o=void 0;try{for(var r,n=i()(this.processform.processCategoryList);!(s=(r=n.next()).done);s=!0){var l=r.value;t.push(l.name),e.push(l.id+"")}}catch(e){a=!0,o=e}finally{try{!s&&n.return&&n.return()}finally{if(a)throw o}}return this.processCategoryName=t.join("；"),this.processCategoryIDs=e.join(","),e.join(",")||""},handleQueryParam:function(e){this.model={approveTime:"",url:"127.0.0.1",port:"3306",companyID:e.organize.orgID||"",startDateFrom:e.date[0],startDateTo:e.date[1],departmentID:e.department.id||"",projectID:e.projects.pc_ID||"",processCategoryIDs:this.handleProcessCategory(),processID:this.handleProcess(),beforeTheDate:e.numDay}}},watch:{processform:{handler:function(e,t){this.handleQueryParam(e)},deep:!0}},computed:o()({bodyHeight:function(){return document.documentElement.clientHeight}},Object(c.b)(["isIE","isSafari","bodyHeight"]))},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"staticReports todoProcess loadingtext"},[s("el-container",[s("el-header",[s("div",{staticClass:"staticReports minWidth"},[s("div",{staticClass:"taticReports-content"},[s("el-row",{staticClass:" staticReports-header ",attrs:{type:"flex",justify:"space-between"}},[s("el-col",{staticClass:"titleMT",attrs:{span:17}},[s("span",{staticClass:"mz",on:{click:function(t){e.$router.back(-1)}}},[e._v("流程报表")]),s("i",{class:e.icon})]),e._v(" "),s("el-col",{staticClass:"titleBtn clearfix",attrs:{span:6}},[s("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.refresh}},[e._v("重置")]),e._v(" "),s("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.search}},[e._v("搜索")])],1)],1)],1)])]),e._v(" "),s("el-main",[s("div",{staticClass:"mainContaint"},[s("div",{staticClass:"todoProcess-screenList screenList-box",class:{screenList_box_ie:e.isIE}},[s("el-row",[s("el-col",{staticClass:"report",attrs:{span:24}},[s("span",[e._v("未结束流程列表")])])],1),e._v(" "),s("el-form",{ref:"processform",staticClass:"todoForm",attrs:{"label-width":"100px",size:"mini"},model:{value:e.processform,callback:function(t){e.processform=t},expression:"processform"}},[s("el-row",{attrs:{type:""}},[s("CascaderOrganize",{ref:"cascaderOrganize",attrs:{isShowStar:!0,defaultFirst:e.defaultFirst},on:{changeSetvaule:e.changeSetvaule}})],1),e._v(" "),s("el-row",{attrs:{type:""}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"发起时段"}},[s("span",{staticStyle:{color:"red","font-size":"14px",float:"left",position:"absolute",top:"0",left:"-10px"}},[e._v("*")]),e._v(" "),s("div",{staticClass:"money-box"},[s("el-form-item",[s("el-date-picker",{staticClass:"todoDate",attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:!1,"picker-options":e.pickerOptionsBefore,placeholder:"选择日期"},on:{focus:e.hideDate},model:{value:e.processform.date[0],callback:function(t){e.$set(e.processform.date,0,t)},expression:"processform.date[0]"}})],1),e._v(" "),s("el-form-item",[e._v("~")]),e._v(" "),s("el-form-item",[s("el-date-picker",{staticClass:"todoDate",staticStyle:{float:"right"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:!1,"picker-options":e.pickerOptionsAfter,placeholder:"选择日期"},on:{focus:e.hideDate},model:{value:e.processform.date[1],callback:function(t){e.$set(e.processform.date,1,t)},expression:"processform.date[1]"}})],1)],1)])],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"流程分类"}},[s("span",{on:{dblclick:function(t){e.openDailog("processClassification")}}},[s("el-input",{staticClass:"input-text",attrs:{placeholder:"请选择...",disabled:"",title:e.processCategoryName},model:{value:e.processCategoryName,callback:function(t){e.processCategoryName=t},expression:"processCategoryName"}})],1),e._v(" "),s("i",{staticClass:"iconfont icon-category ",on:{click:function(t){e.openDailog("processClassification")}}})])],1),e._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"流程"}},[s("span",{on:{dblclick:function(t){e.openDailog("processSelection")}}},[s("el-input",{staticClass:"input-text",attrs:{placeholder:"请选择...",disabled:"",title:e.processName},model:{value:e.processName,callback:function(t){e.processName=t},expression:"processName"}})],1),e._v(" "),s("i",{staticClass:"iconfont icon-category ",on:{click:function(t){e.openDailog("processSelection")}}})])],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"审批超过"}},[s("span",{staticStyle:{color:"red","font-size":"14px",float:"left",position:"absolute","z-index":"99",top:"0",left:"-10px"}},[e._v("*")]),e._v(" "),s("span",{staticClass:"clearfix"},[s("el-input",{staticClass:"input-embedded input-text",attrs:{type:"text"},on:{input:function(t){e.inputValidate(e.processform.numDay)}},model:{value:e.processform.numDay,callback:function(t){e.$set(e.processform,"numDay",t)},expression:"processform.numDay"}}),e._v(" "),s("i",{staticClass:" text-embedded"},[e._v("天未结束")])],1)])],1)],1)],1),e._v(" "),s("div",{staticClass:"todoProcess-main"},[s("el-row",{staticClass:"listButton",attrs:{type:"flex",justify:"end"}},[s("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",icon:"iconfont icon-export",size:"mini"},on:{click:e.exportList}},[e._v("导出\n              ")])],1),e._v(" "),s("div",{staticClass:"list",class:{table_safari:e.isSafari}},[s("el-table",{ref:"singleTable",attrs:{height:e.bodyHeight-400,data:e.tableData,"header-row-class-name":e.tableHeaderClassName,border:"","highlight-current-row":"",size:"mini"},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{sortable:"custom",property:"processInstanceID",label:"流程ID",width:"100px"}}),e._v(" "),s("el-table-column",{attrs:{sortable:"custom",width:"120px",property:"categoryFullName",align:"left",label:"流程类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.categoryFullName}},[e._v(e._s(t.row.categoryFullName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"80px",sortable:"custom",property:"processName",label:"流程"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.processName}},[e._v(e._s(t.row.processName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"120px",sortable:"custom",property:"folio",label:"流程主题"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover folio",attrs:{title:t.row.folio},on:{click:function(s){e.jumpToOld(t.row)}}},[e._v(e._s(t.row.folio))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"120px",sortable:"custom",property:"departmentName",label:"部门名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.departmentName}},[e._v(e._s(t.row.departmentName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"100px",sortable:"custom",property:"projectName",label:"项目"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.projectName}},[e._v(e._s(t.row.projectName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"100px",sortable:"custom",property:"originator",label:"发起人"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.originator}},[e._v(e._s(t.row.originator))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"110px",sortable:"custom",prop:"startDate",label:"发起时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:e._f("moment")(t.row.startDate)}},[e._v(e._s(e._f("moment")(t.row.startDate)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{sortable:"custom",property:"activityName",width:"130px",label:"审批步骤名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.activityName}},[e._v(e._s(t.row.activityName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{sortable:"custom",property:"curDest",width:"120px",label:"当前处理人"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.curDest}},[e._v(e._s(t.row.curDest))])]}}])}),e._v(" "),s("el-table-column",{attrs:{sortable:"custom",property:"curDepartment",label:"当前处理人所属部门",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.curDepartment}},[e._v(e._s(t.row.curDepartment))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"lastApprovedDate",sortable:"custom",width:"130px",label:"上次审批时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.lastApprovedDate}},[e._v(e._s(t.row.lastApprovedDate))])]}}])}),e._v(" "),s("el-table-column",{attrs:{property:"lastTime",width:"120px",sortable:"custom",label:"持续时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-popover",attrs:{title:t.row.lastTime}},[e._v(e._s(t.row.lastTime))])]}}])}),e._v(" "),s("div",{attrs:{slot:"empty"},slot:"empty"},[s("p",[e._v("暂无数据")])]),e._v(" "),s("div",{attrs:{slot:"append"},slot:"append"},[e.tableData.length>0?s("page",{attrs:{pageIndex:e.pageIndex,total:e.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}):e._e()],1)],1)],1)],1)],1)]),e._v(" "),e.showdialog?s(e.componentParam.componentType,{tag:"component",attrs:{componentParam:e.componentParam},on:{hideComponent:e.hideComponent,sureSubmit:e.showMsgfromchild}}):e._e()],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")(y,b,!1,function(e){s("dUPS")},"data-v-0e0ebfd6",null);t.default=_.exports},dUPS:function(e,t){}});
//# sourceMappingURL=34.a479da31ba4a45940ef7.js.map