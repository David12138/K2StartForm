webpackJsonp([1],{mvpY:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("BO1k"),o=a.n(s),r=a("woOf"),i=a.n(r),n=a("Dd8w"),l=a.n(n),c=a("NYxO"),p=a("PJh5"),d=a.n(p),m=a("Lxn6"),u=a("T//Y"),f=a("8IKV"),h=a("J9uR"),v=a("Xg7m"),g=a("+vjY"),y={name:"processInstance",components:{CascaderOrganize:f.a,processClassification:v.a,processSelection:h.a,page:u.a},computed:l()({bodyHeight:function(){return document.documentElement.clientHeight}},Object(c.b)(["isIE","bodyHeight"])),data:function(){var e=this;return{pickerOptionsBefore:{disabledDate:function(t){var a=e.processform.date[1];if(a)return d()(t).format("YYYY-MM-DD")>a}},pickerOptionsAfter:{disabledDate:function(t){var a=e.processform.date[0];if(a)return d()(t).format("YYYY-MM-DD")<a}},tableData:[],processFormName:"",processCategoryName:"",processCategoryIDs:"",processName:"",processIDs:"",defaultFirst:["organize"],processform:{organize:{},department:{},projects:{},date:[d()().subtract(1,"months").format("YYYY-MM-DD"),d()().format("YYYY-MM-DD")],processCategoryList:[],processList:[]},model:{url:"127.0.0.1",port:"3306",companyID:"",startDateFrom:"",startDateTo:"",departmentID:"",projectID:"",processCategoryIDs:"",processID:""},showdialog:!1,componentParam:{componentType:{type:String,required:!0},backfillData:{type:Array,required:!0},oneCheck:{type:Boolean,required:!0},closeShow:{type:Boolean,required:!0}},pageIndex:1,total:0,pageSize:20,pageSizesList:[20,50,100]}},mounted:function(){},methods:{jumpToOld:function(e){if(m.a.browserIsIE()){var t=escape(e.viewUrl);window.open("oldIframe.html?viewurl="+t,"_blank")}else window.open(e.viewUrl)},sortChange:function(e){var t="statusName"==e.prop?"dodoType":e.prop;this.model.orderBy=t+" "+e.order.replace("ending",""),this.pageIndex=1,this.getResultList()},hideDate:function(e){setTimeout(function(){var t=void 0,a=void 0,s=null,o=null;document.getElementsByClassName("el-picker-panel")[0]&&(s=!0),document.getElementsByClassName("el-picker-panel")[1]&&(o=!0),t=s?document.getElementsByClassName("el-picker-panel")[0]:"",a=o?document.getElementsByClassName("el-picker-panel")[1]:"",e.$el.firstElementChild==document.activeElement?(s&&(t.style.display="none"),o&&(a.style.display="none")):(s&&(t.style.display="block"),o&&(a.style.display="block"))},10)},handleSizeChange:function(e){this.pageIndex=1,this.pageSize=parseInt(e),localStorage.myInitPageSize=e,console.log(e,"size"),this.getResultList()},handleCurrentChange:function(e){this.pageIndex=e,console.log(e,"current"),this.getResultList()},changeSetvaule:function(e){this.processform=i()({},this.processform,e.data)},tableHeaderClassName:function(e){e.row,e.rowIndex;return"table-head-th"},openDailog:function(e){this.componentParam.closeShow=!1,this.componentParam.componentType=e,this.componentParam.oneCheck=!1,"processClassification"==e?this.componentParam.backfillData=this.processform.processCategoryList:"processSelection"==e&&(this.componentParam.backfillData=this.processform.processList),this.showdialog=!0,m.a.showDailog_mask()},hideComponent:function(){this.showdialog=!1,m.a.hiddenDailog_mask()},showMsgfromchild:function(e){e.type&&"processClassification"===e.type?(this.processform.processCategoryList=e.list,this.handleProcessCategory()):e.type&&"processSelection"===e.type&&(this.processform.processList=e.list,this.handleProcess()),this.hideComponent()},search:function(){this.getResultList()},refresh:function(){this.processform={organize:{},department:{},projects:{},date:[d()().subtract(1,"months").format("YYYY-MM-DD"),d()().format("YYYY-MM-DD")],processCategoryList:[],processList:[]},this.$refs.cascaderOrganize.$emit("refresh")},exportList:function(){var e=this;""!==this.model.processCategoryIDs||""!==this.model.processID?(g.a.startLoading({lock:!0,text:"加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")}),e.$axios.post("/api/exportExcelForTable",{tableName:"审批操作基础数据表",params:e.model},{responseType:"blob"}).then(function(e){var t=e.data;m.a.exportSearchList("审批操作基础数据表",t),g.a.endLoading()}).catch(function(t){g.a.endLoading(),e.$message.error("导出Excel失败!ERROR MESSAGE:"+t)})):this.$message.warning("请选择流程分类或流程")},getResultList:function(){var e=this;""!==this.model.companyID?""!==this.model.processCategoryIDs||""!==this.model.processID?this.model.startDateFrom&&this.model.startDateTo?""===this.model.startDateFrom&&""===this.model.startDateTo||!(this.model.startDateFrom<"1753-01-01"||this.model.startDateTo<"1753-01-01")?(g.a.startLoading(),this.$axios.post("/api/ProcessOperation/page?pageIndex="+(this.pageIndex-1)+"&pageSize="+this.pageSize,this.model).then(function(t){g.a.endLoading(),200===t.status?(e.tableData=t.data.processOperationList,e.total=t.data.pageControllerInfo.totalRecordCount):e.$message.error("请求失败！")}).catch(function(t){g.a.endLoading(),e.$message.error("查询列表数据失败!ERROR MESSAGE:"+t)})):this.$message.warning("请选择1753-01-01 ~ 9999-12-31之间的日期"):this.$message.warning("请选择日期"):this.$message.warning("请选择流程分类或流程"):this.$message.warning("请选择所属公司")},handleProcess:function(){var e=[],t=[],a=!0,s=!1,r=void 0;try{for(var i,n=o()(this.processform.processList);!(a=(i=n.next()).done);a=!0){var l=i.value;t.push(l.name),e.push(l.processId+"")}}catch(e){s=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(s)throw r}}return this.processName=t.join("；"),this.processIDs=e.join(","),e.join(",")||""},handleProcessCategory:function(){var e=[],t=[],a=!0,s=!1,r=void 0;try{for(var i,n=o()(this.processform.processCategoryList);!(a=(i=n.next()).done);a=!0){var l=i.value;t.push(l.name),e.push(l.id+"")}}catch(e){s=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(s)throw r}}return this.processCategoryName=t.join("；"),this.processCategoryIDs=e.join(","),e.join(",")||""},handleQueryParam:function(e){var t=[];if(e.date){var a=!0,s=!1,r=void 0;try{for(var i,n=o()(e.date);!(a=(i=n.next()).done);a=!0){var l=i.value;t.push(l)}}catch(e){s=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(s)throw r}}}this.model={url:"127.0.0.1",port:"3306",companyID:e.organize.orgID||"",startDateFrom:t[0],startDateTo:t[1],departmentID:e.department.id||"",projectID:e.projects.pc_ID||"",processCategoryIDs:this.handleProcessCategory(),processID:this.handleProcess()}}},watch:{processform:{handler:function(e,t){this.handleQueryParam(e)},deep:!0}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"staticReports loadingtext todoProcess "},[a("el-container",[a("el-header",[a("div",{staticClass:"staticReports minWidth"},[a("div",{staticClass:"taticReports-content"},[a("el-row",{staticClass:" staticReports-header ",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{staticClass:"titleMT",attrs:{span:17}},[a("span",{staticClass:"mz",on:{click:function(t){e.$router.back(-1)}}},[e._v("流程报表")]),a("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),a("el-col",{staticClass:"titleBtn clearfix",attrs:{span:6}},[a("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:function(t){e.refresh()}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:function(t){e.search()}}},[e._v("搜索")])],1)],1)],1)])]),e._v(" "),a("el-main",[a("div",{staticClass:"mainContaint"},[a("div",{staticClass:"todoProcess-screenList screenList-box",class:{screenList_box_ie:e.isIE}},[a("el-row",[a("el-col",{staticClass:"report",attrs:{span:24}},[a("span",[e._v("审批操作基础数据表")])])],1),e._v(" "),a("el-form",{ref:"processform",staticClass:"todoForm",attrs:{"label-width":"100px",size:"mini"},model:{value:e.processform,callback:function(t){e.processform=t},expression:"processform"}},[a("el-row",{attrs:{type:""}},[a("CascaderOrganize",{ref:"cascaderOrganize",attrs:{isShowStar:!0,defaultFirst:e.defaultFirst},on:{changeSetvaule:e.changeSetvaule}})],1),e._v(" "),a("el-row",{attrs:{type:""}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"发起时段"}},[a("span",{staticStyle:{color:"red","font-size":"14px",float:"left",position:"absolute",top:"0",left:"-10px"}},[e._v("*")]),e._v(" "),a("div",{staticClass:"money-box"},[a("el-form-item",[a("el-date-picker",{staticClass:"todoDate",attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:!1,"picker-options":e.pickerOptionsBefore,placeholder:"选择日期"},on:{focus:e.hideDate},model:{value:e.processform.date[0],callback:function(t){e.$set(e.processform.date,0,t)},expression:"processform.date[0]"}})],1),e._v(" "),a("el-form-item",[e._v("~")]),e._v(" "),a("el-form-item",[a("el-date-picker",{staticClass:"todoDate",staticStyle:{float:"right"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:!1,"picker-options":e.pickerOptionsAfter,placeholder:"选择日期"},on:{focus:e.hideDate},model:{value:e.processform.date[1],callback:function(t){e.$set(e.processform.date,1,t)},expression:"processform.date[1]"}})],1)],1)])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"流程分类"}},[a("span",{on:{dblclick:function(t){e.openDailog("processClassification")}}},[a("el-input",{staticClass:"input-text",attrs:{disabled:"",placeholder:"请选择...",title:e.processCategoryName},model:{value:e.processCategoryName,callback:function(t){e.processCategoryName=t},expression:"processCategoryName"}})],1),e._v(" "),a("i",{staticClass:"iconfont icon-category ",on:{click:function(t){e.openDailog("processClassification")}}})])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"流程"}},[a("span",{on:{dblclick:function(t){e.openDailog("processSelection")}}},[a("el-input",{staticClass:"input-text",attrs:{disabled:"",placeholder:"请选择...",title:e.processName},model:{value:e.processName,callback:function(t){e.processName=t},expression:"processName"}})],1),e._v(" "),a("i",{staticClass:"iconfont icon-category ",on:{click:function(t){e.openDailog("processSelection")}}})])],1)],1)],1),e._v(" "),a("div",{staticClass:"todoProcess-main"},[a("el-row",{staticClass:"listButton",attrs:{type:"flex",justify:"end"}},[a("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",icon:"iconfont icon-export",size:"mini"},on:{click:function(t){e.exportList()}}},[e._v("导出")])],1),e._v(" "),a("div",{staticClass:"list"},[a("el-table",{ref:"singleTable",attrs:{height:e.bodyHeight-360,"header-row-class-name":e.tableHeaderClassName,border:"","highlight-current-row":"",data:e.tableData,size:"mini"},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{prop:"userID","min-width":"120px",sortable:"custom",label:"审批人账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.userID}},[e._v(e._s(t.row.userID))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",width:"110px",sortable:"custom",label:"审批人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.userName}},[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"processInstanceID",width:"100px",sortable:"custom",label:"流程ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"categoryFullName",width:"120px",align:"left",sortable:"custom",label:"流程类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.categoryFullName}},[e._v(e._s(t.row.categoryFullName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"processName",width:"80px",sortable:"custom",label:"流程"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.processName}},[e._v(e._s(t.row.processName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"folio",sortable:"custom",width:"120px",label:"流程主题"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover folio",attrs:{title:t.row.folio},on:{click:function(a){e.jumpToOld(t.row)}}},[e._v(e._s(t.row.folio))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"amountOfMoney",width:"100px",sortable:"custom",label:"金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"departmentName",width:"120px",sortable:"custom",label:"部门名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.departmentName}},[e._v(e._s(t.row.departmentName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"projectName",sortable:"custom",width:"100px",label:"项目"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.projectName}},[e._v(e._s(t.row.projectName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"startDate",sortable:"custom",width:"120px",label:"发起时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.startDate}},[e._v(e._s(t.row.startDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"acceptDate",sortable:"custom",width:"120px",label:"接收时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.acceptDate}},[e._v(e._s(t.row.acceptDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{sortable:"custom",prop:"approvalDate",width:"135px",label:"处理完成时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.approvalDate}},[e._v(e._s(t.row.approvalDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"totaltime",sortable:"custom",width:"120px",label:"审批时长"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.totaltime}},[e._v(e._s(t.row.totaltime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"activityName",sortable:"custom",width:"135px",label:"审批步骤名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-popover",attrs:{title:t.row.activityName}},[e._v(e._s(t.row.activityName))])]}}])}),e._v(" "),a("div",{attrs:{slot:"empty"},slot:"empty"},[a("p",[e._v("暂无数据")])]),e._v(" "),a("div",{attrs:{slot:"append"},slot:"append"},[e.tableData.length>0?a("page",{attrs:{pageIndex:e.pageIndex,total:e.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}):e._e()],1)],1)],1)],1)],1)]),e._v(" "),e.showdialog?a(e.componentParam.componentType,{tag:"component",attrs:{componentParam:e.componentParam},on:{hideComponent:e.hideComponent,sureSubmit:e.showMsgfromchild}}):e._e()],1)],1)],1)},staticRenderFns:[]};var C=a("VU/8")(y,b,!1,function(e){a("nhq+")},"data-v-567a0522",null);t.default=C.exports},"nhq+":function(e,t){}});
//# sourceMappingURL=1.96511896a718eb0c551c.js.map