webpackJsonp([28],{714:function(t,e,a){"use strict";var i=a(160),s=a.n(i),o={name:"selectedPersonnel",props:{childDataUrl:{type:Object,required:!0},closeShow:!1,oneCheck:{type:Boolean,default:!0}},mounted:function(){this.childDataUrl.chooseProject&&this.childDataUrl.chooseProject.item&&this.childDataUrl.chooseProject.last&&(this.treeNode=this.childDataUrl.chooseProject.item,this.last=this.childDataUrl.chooseProject.last,this.checkedCitie.push(this.treeNode))},data:function(){return{organName:"",mianbao:[],value:"",options:[],bread:"",fullSearch:"",treeSearch:"",checkAll:!1,checkedCitie:[],cities:[],isIndeterminate:!1,organizationData:[],oldtime:0,defaultProps:{children:"m_ChildOrg",label:"orgName",isLeaf:function(t,e){return!(t&&t.isParent>0)}},last:{},treeNode:{},isActive:!1,tooltipOrganName:"",defaultKeys:[],isSeach:!1,treeQuery:!1}},watch:{treeSearch:function(t){var e=this;e.treeQuery=!0,e.queryName=t,this.loading=!0,this.isSeach||""==e.queryName.trim()||(this.isSeach=!0,setTimeout(function(){e.isSeach=!1,e.searchTree(e.queryName)},2e3))}},methods:{searchTree:function(t){var e=this,a=null;this.childDataUrl.isFirst&&(a=this.childDataUrl.isFirst),this.$axios.post("/api/"+this.childDataUrl.getTree,{orgName:t,isFirst:a}).then(function(t){e.organizationData=e.toTree(t.data.result)}).catch(function(t){e.$message.error("查询部门组织数据失败!ERROR MESSAGE:"+t)})},pullBtnHeightChange:function(){this.isActive=!this.isActive},disposeOrganName:function(t){for(var e="",a=0;a<t.length;a++){e+=t[a].text+">"}return e=e.substr(0,e.length-1),this.tooltipOrganName=e,e.length>30?this.bread=e.substr(0,30)+"...":this.bread=e,e},handleNodeClick:function(t,e){var a=(new Date).getTime();if(this.oldtime&&a-this.oldtime<200)return this.treeNode.orgFullName=e.data.orgFullName,this.treeNode.orgID=e.data.orgID,this.treeNode.orgName=e.data.orgName,this.treeNode.parentOrgID=e.data.parentOrgID,this.clickDepartment(this.treeNode),void this.$emit("sureSubmit",{type:"project",item:this.treeNode,last:this.last});if(this.oldtime=a,e.isLeaf){this.cities=[];var i={};i.isParent=t.isParent,i.orgFullName=t.orgFullName,i.orgID=t.orgID,i.orgName=t.orgName,i.parentOrgID=t.parentOrgID,this.cities.push(i)}else{this.cities=[];for(var s=0;e.childDatas&&s<e.childDatas.length;s++)this.cities.push(e.childDatas[s])}for(s=0;s<this.cities.length;s++){for(var o=!1,r=0;r<this.checkedCitie.length;r++)if(this.cities[s].orgID===this.checkedCitie[r].orgID){o=!0;break}this.cities[s].checked=!!o}this.mianbao=[],this.getPrarentNode(e),this.disposeOrganName(this.mianbao)},handleNodeload:function(t,e){var a=this;if(t.data&&0!=t.data.length)if(this.mianbao=[],t.data.m_ChildOrg&&t.data.m_ChildOrg.length>0){var i=[];t.childDatas=[];for(var s=0;s<t.data.m_ChildOrg.length;s++)i.push(t.data.m_ChildOrg[s]),t.childDatas.push(t.data.m_ChildOrg[s]);delete t.data.m_ChildOrg,e(i)}else this.$axios.post("/api/"+this.childDataUrl.getTree,{orgDepId:t.data.orgID}).then(function(i){if(200===i.status){t.childDatas=[],a.cities=[];for(var s=0;s<i.data.result.length;s++)t.childDatas.push(i.data.result[s]),a.cities.push(i.data.result[s]);e(i.data.result)}else a.$message.error("请求失败！")}).catch(function(t){that.$message.error("查询数据失败!ERROR MESSAGE:"+t)});else this.getTree(e)},getTree:function(t){var e=this,a=null;this.childDataUrl.isFirst&&(a=this.childDataUrl.isFirst),this.$axios.post("/api/"+this.childDataUrl.getTree,{orgDepId:"A5A40ECE-0DBD-4F2B-89E8-6BA91B91EBF4",isFirst:a}).then(function(a){200===a.status?(e.organizationData=e.toTree(a.data.result),t&&(t(e.organizationData),e.defaultKeys[0]=e.organizationData[0].orgID)):e.$message.error("请求失败！")}).catch(function(t){e.$message.error("查询部门组织数据失败!ERROR MESSAGE:"+t)})},sureSubmit:function(){this.checkedCitie&&0!==this.checkedCitie.length?this.oneCheck?this.$emit("sureSubmit",{type:"project",item:this.treeNode,last:this.last}):this.$emit("sureSubmit",{type:"project",items:this.checkedCitie}):this.$message.warning("请选择数据!")},close:function(){this.$emit("hideComponent")},searchProject:function(){},toTree:function(t){if(null==t||0==t.length)return[];t.forEach(function(t){delete t.m_ChildOrg});var e={};t.forEach(function(t){e[t.orgID]=t});var a=[];return t.forEach(function(t){var i=e[t.parentOrgID];i?(i.m_ChildOrg||(i.m_ChildOrg=[])).push(t):a.push(t)}),a},checkChangeNode:function(t,e,a){},handleCheckAllChange:function(t){if(t){for(var e=0;e<this.cities.length;e++){for(var a=!1,i=0;i<this.checkedCitie.length;i++)this.checkedCitie[i].orgID===this.cities[e].orgID&&(a=!0);a||this.checkedCitie.push(this.cities[e])}this.isIndeterminate=!0}else{for(e=0;e<this.cities.length;e++){for(a=!1,i=0;i<this.checkedCitie.length;i++)if(this.checkedCitie[i].orgID===this.cities[e].orgID){a=!0;break}a&&this.checkedCitie.splice(i,1)}this.isIndeterminate=!1}},handleCheckedCitiesChange:function(t){this.checkedCitie=t;var e=t.length;this.checkAll=e===this.cities.length,this.isIndeterminate=e>0&&e<this.cities.length},clickDepartment:function(t){var e=this;this.checkedCitie.splice(0,this.checkedCitie.length),this.checkedCitie.push(t);var a=this.$refs.tree2.getNode(t.orgID);this.mianbao=[],this.getPrarentNode(a),e.organName="";var i=!0,o=!1,r=void 0;try{for(var n,l=s()(e.mianbao);!(i=(n=l.next()).done);i=!0){var c=n.value;e.organName+=c.text+">"}}catch(t){o=!0,r=t}finally{try{!i&&l.return&&l.return()}finally{if(o)throw r}}e.organName+=""+t.orgName,e.treeNode=t,e.last.lastNode="",e.last.lastId="",e.mianbao.forEach(function(t){e.last.lastNode+=t.text+"-",e.last.lastId=t.petId}),e.last.lastNode=e.last.lastNode.substr(0,e.last.lastNode.length-1)},dblclickCheckedCitie:function(t){this.clickDepartment(t),this.$emit("sureSubmit",{type:"project",item:t,last:this.last})},deleteProject:function(t,e){this.checkedCitie.splice(e,1)},clearProject:function(){this.checkedCitie.splice(0,this.checkedCitie.length),this.checkAll=!1,this.isIndeterminate=!1},getPrarentNode:function(t){void 0!=t.data.orgName&&this.mianbao.unshift({text:""+t.data.orgName,petId:""+t.data.orgID}),void 0!=t.parent&&this.getPrarentNode(t.parent)},getChild:function(t){void 0!==t.childNodes&&0!==t.childNodes.length||(this.last={lastNode:t.data.orgName,lastId:t.data.orgID})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"originater_dialog project_dialog"},[a("div",{class:[t.closeShow?"pc-candidates":"pc-candidates pc-background"]},[a("div",{staticClass:"dialog_content"},[a("el-main",{staticStyle:{position:"relative"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.closeShow,expression:"!closeShow"}],staticClass:"top"},[t._v("组织选择"),a("span",{staticStyle:{"font-size":"30px",cursor:"pointer",float:"right","padding-right":"5px"},on:{click:t.close}},[t._v("×")])]),t._v(" "),a("el-tabs",{attrs:{type:"card"}},[a("el-tab-pane",{staticClass:"candidates-recently"},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont icon-todos"}),t._v(" 组织")]),t._v(" "),a("div",{staticClass:"title  title-border"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("组织架构")]),t._v(" "),a("el-breadcrumb-item",{attrs:{title:t.tooltipOrganName}},[t._v(t._s(t.bread))])],1),t._v(" "),a("span",{staticClass:"rightInput"},[a("el-input",{attrs:{placeholder:"请输入部门关键字","prefix-icon":"el-icon-search",size:"mini"},model:{value:t.treeSearch,callback:function(e){t.treeSearch=e},expression:"treeSearch"}})],1)],1),t._v(" "),a("div",{staticClass:"content clearfix"},[a("div",{staticClass:"content-left"},[a("el-tree",{ref:"tree2",attrs:{data:t.organizationData,"node-key":"orgID","highlight-current":!0,props:t.defaultProps,"default-expanded-keys":t.defaultKeys,"default-checked-keys":t.defaultKeys,load:t.handleNodeload,lazy:""},on:{"node-click":t.handleNodeClick}})],1),t._v(" "),a("div",{staticClass:"content-right"},[t.oneCheck?t._e():a("el-checkbox",{staticStyle:{"padding-top":"6px"},attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选\n                ")]),t._v(" "),t.oneCheck?a("el-checkbox-group",{staticClass:"theRadio",on:{change:t.handleCheckedCitiesChange},model:{value:t.checkedCitie,callback:function(e){t.checkedCitie=e},expression:"checkedCitie"}},t._l(t.cities,function(e){return a("el-checkbox-button",{key:e.orgID,attrs:{label:e}},[a("div",{staticClass:"media"},[a("div",{staticClass:"media-body",on:{click:function(a){t.clickDepartment(e)},dblclick:function(a){t.dblclickCheckedCitie(e)}}},[a("h4",{staticClass:"media-heading iconfont icon-company"},[t._v(t._s(e.orgName))])])])])})):a("el-checkbox-group",{staticClass:"mut-check",on:{change:t.handleCheckedCitiesChange},model:{value:t.checkedCitie,callback:function(e){t.checkedCitie=e},expression:"checkedCitie"}},t._l(t.cities,function(e,i){return a("el-checkbox",{key:i,attrs:{label:e,checked:e.checked}},[a("div",{staticClass:"media"},[a("div",{staticClass:"media-body mut-media-body"},[a("h4",{staticClass:"media-heading iconfont icon-company"},[t._v(t._s(e.orgName))])])])])}))],1)]),t._v(" "),a("div",{staticClass:"addrecently",class:{pullup:t.isActive}},[a("div",{staticClass:"media"},[a("div",{staticClass:"pull",on:{click:t.pullBtnHeightChange}}),t._v(" "),a("ul",{staticClass:"clearfix"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.checkedCitie.length>0,expression:"checkedCitie.length>0"}],staticClass:"clearBtn",on:{click:t.clearProject}}),t._v(" "),t._l(t.checkedCitie,function(e,i){return a("li",{key:e.orgID},[a("div",{staticClass:"media-body"},[a("i",{staticClass:"el-icon-circle-close",on:{click:function(a){t.deleteProject(e,i)}}}),t._v(" "),a("span",{staticClass:"media-heading"},[t._v(t._s(e.orgName))])])])})],2)])]),t._v(" "),a("div",{staticClass:"addrecently-footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check-outline",size:"mini"},on:{click:t.sureSubmit}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-close-outline",size:"mini"},on:{click:t.close}},[t._v("取消")])],1)])],1)],1)],1)])])},staticRenderFns:[]};var n=a(47)(o,r,!1,function(t){a(715)},"data-v-7a420611",null);e.a=n.exports},715:function(t,e){},756:function(t,e){},795:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(714),s=a(1),o=a.n(s),r=a(67),n=a(359),l=o()().day(0).format("YYYY-MM-DD"),c=o()().day(6).format("YYYY-MM-DD"),h=o()().startOf("month").format("YYYY-MM-DD"),d=o()().endOf("month").format("YYYY-MM-DD"),g=o()().startOf("quarter").format("YYYY-MM-DD"),u=o()().endOf("quarter").format("YYYY-MM-DD"),m=o()().startOf("year").format("YYYY-MM-DD"),p=o()().endOf("year").format("YYYY-MM-DD"),f={name:"",components:{project_dialog:i.a},data:function(){return{organSelectVal:"",comp:{},childDataUrl:{url:""},showdialog:!1,fullHeight:document.documentElement.clientHeight,organSelectRadio:1,model:{selectForm:{},date:""},oneCheck:!1,startDate:"",endDate:"",isShow:!0,isShowReportCondition:!0,arrtReportCondition:"收起",icon:"el-icon-arrow-down",iconIf:"el-icon-arrow-up",tableData:[],orgDepId:"",orderBy:"",imgLoading:!1}},mounted:function(){},methods:{change:function(){switch(this.organSelectRadio){case 1:this.startDate=l,this.endDate=c;break;case 2:this.startDate=h,this.endDate=d;break;case 3:this.startDate=g,this.endDate=u;break;case 4:this.startDate=m,this.endDate=p;break;case 5:this.startDate=this.model.date[0]?this.model.date[0]+" 00:00:00":"",this.endDate=this.model.date[1]?this.model.date[1]+" 23:59:59":""}},getExportDataList:function(t){var e=this;this.change();var a={startDate:this.startDate,endDate:this.endDate,orgDepId:this.orgDepId,orderBy:this.orderBy};n.a.startLoading(),e.$axios.post("/api/StatisticalreturnratePeople/page",a).then(function(a){e.exportData=a.data.processesReportList,t(),n.a.endLoading()}).catch(function(t){e.$message.error("查询列表数据失败!ERROR MESSAGE:"+t),n.a.endLoading()})},exportList:function(){var t=this;this.change(),n.a.startLoading({lock:!0,text:"数据量过大，正在拼命加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")});var e={startDate:this.startDate,endDate:this.endDate,orgDepId:this.orgDepId?parseInt(this.orgDepId):null,orderBy:this.orderBy,filterEmptyComment:"0",userID:""};t.$axios.post("/api/exportExcelForTable",{tableName:"动态-岗位/人-以“人”统计退回率",params:e},{responseType:"blob"}).then(function(t){var e=t.data;r.a.exportSearchList("动态-岗位/人-以“人”统计退回率",e),n.a.endLoading()}).catch(function(e){n.a.endLoading(),t.$message.error("导出Excel失败!ERROR MESSAGE:"+e)})},showToggleReportCondition:function(){this.isShowReportCondition=!this.isShowReportCondition,this.isShowReportCondition?(this.arrtReportCondition="收起",this.iconIf="el-icon-arrow-up"):(this.arrtReportCondition="展开",this.iconIf="el-icon-arrow-down")},rowClick:function(t,e,a){a.label},getList:function(){var t=this;if(0!==this.orgDepId.length){this.imgLoading=!0,this.change();var e={startDate:this.startDate,endDate:this.endDate,orgDepId:this.orgDepId,orderBy:this.orderBy};this.$axios.post("/api/StatisticalreturnratePeople/page",e).then(function(e){t.tableData=e.data.statisticalreturnrate;for(var a=0;a<e.data.statisticalreturnrate.length;a++)e.data.statisticalreturnrate[a].returnRate=parseFloat(e.data.statisticalreturnrate[a].returnRate)+"%";t.imgLoading=!1}).catch(function(e){t.imgLoading=!1})}else this.$message.warning("请选择组织进行查询！")},sortChange:function(t){this.orderBy=t.prop+" "+t.order.replace("ending",""),this.getList()},openDialog:function(t,e){this.comp.component=t,this.showdialog=!0,r.a.showDailog_mask(),this.oneCheck=!0,this.childDataUrl.getTree="getTree",this.childDataUrl.isFirst="2"},hideComponent:function(){this.showdialog=!1,r.a.hiddenDailog_mask()},showMsgfromchild:function(t){if(this.oneCheck){var e=t.last.lastNode;this.model.companys_t=e,this.model.companys=e,this.model.companys.length>15&&(this.model.companys=this.model.companys.substr(0,20)+"..."),this.model.selectForm.departmentID=t.item.orgID,this.model.selectForm.companyCode=t.last.lastId.toString(),this.childDataUrl.chooseProject=t,this.orgDepId=t.last.lastId,this.organSelectVal=e}this.hideComponent()},search:function(){this.getList()},refresh:function(){this.childDataUrl.chooseProject=new Array,this.startDate="",this.endDate="",this.organSelectVal="",this.organSelectRadio=1,this.orgDepId="",this.orderBy=""}},computed:{},watch:{fullHeight:function(){return document.documentElement.clientHeight}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"staticReports"},[a("el-container",[a("el-header",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.imgLoading,expression:"imgLoading"}],staticClass:"staticReports loadingtext minWidth",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("div",{staticClass:"taticReports-content"},[a("el-row",{staticClass:"staticReports-header",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{staticClass:"titleMT",attrs:{span:17}},[a("span",{staticClass:"mz",on:{click:function(e){t.$router.back(-1)}}},[t._v("流程报表")]),a("i",{class:t.icon})]),t._v(" "),a("el-col",{staticClass:"titleBtn clearfix",attrs:{span:6}},[a("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:t.refresh}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:t.search}},[t._v("搜索")])],1)],1),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"statement reportCondition"},[a("span",{staticClass:"fz16"},[t._v("动态-岗位/人-以“人”统计退回率")]),t._v(" "),a("el-row",{staticClass:"staticReports-middle lh35  staticReportsMiddle"},[a("el-col",{staticClass:"processSelect",attrs:{span:2,sm:4,md:1}},[a("span",[t._v("组织选择")])]),t._v(" "),a("el-col",{staticClass:"process-inputbox",attrs:{span:14}},[a("i",{staticClass:"iconfont icon-organization",on:{click:function(e){t.openDialog("project_dialog")}}}),t._v(" "),a("el-input",{staticClass:"el-inputHeigth",attrs:{disabled:!0,size:"mini"},nativeOn:{dblclick:function(e){t.openDialog("project_dialog")}},model:{value:t.organSelectVal,callback:function(e){t.organSelectVal=e},expression:"organSelectVal"}})],1)],1),t._v(" "),a("el-row",{staticClass:"reportCondition-date reportConditionDate"},[a("el-col",{staticClass:"timeDuan zj",attrs:{span:2,sm:4,md:1}},[a("span",[t._v("时间段")])]),t._v(" "),a("el-col",{staticClass:"timeSelect",attrs:{span:7,sm:8}},[a("el-radio-group",{model:{value:t.organSelectRadio,callback:function(e){t.organSelectRadio=e},expression:"organSelectRadio"}},[a("el-radio",{attrs:{label:1}},[t._v("本周")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("本月")]),t._v(" "),a("el-radio",{attrs:{label:3}},[t._v("本季度")]),t._v(" "),a("el-radio",{attrs:{label:4}},[t._v("本年")]),t._v(" "),a("el-radio",{attrs:{label:5}},[t._v("其他")])],1)],1),t._v(" "),5===t.organSelectRadio?a("el-col",{attrs:{span:7,sm:6}},[a("div",{staticClass:"border"},[a("el-date-picker",{staticStyle:{width:"auto"},attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.model.date,callback:function(e){t.$set(t.model,"date",e)},expression:"model.date"}})],1)]):t._e(),t._v(" "),a("el-col",{staticClass:"buttonWrap  buttonWrapTA",attrs:{span:4}},[a("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:t.exportList}},[a("i",{staticClass:"iconfont icon-export"}),t._v("导出")])],1)],1)],1),t._v(" "),a("div",{staticClass:"statement"},[a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{height:t.isShowReportCondition?t.fullHeight-270:t.fullHeight-280,data:t.tableData,"highlight-current-row":"",border:""},on:{"sort-change":t.sortChange}},[a("el-table-column",{attrs:{align:"center",property:"rowNumber",sortable:"custom",width:"120",label:"排名"}}),t._v(" "),a("el-table-column",{attrs:{align:"left",property:"userName",sortable:"custom",label:"岗位"}}),t._v(" "),a("el-table-column",{attrs:{align:"left",property:"department",sortable:"custom",label:"部门"}}),t._v(" "),a("el-table-column",{attrs:{prop:"processTotalCnt",sortable:"custom",label:"处理实例数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"returnCnt",sortable:"custom",label:"退回实例数"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",property:"returnRate",sortable:"custom",label:"退回率",width:"120"}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.imgLoading,expression:"!imgLoading"}],attrs:{slot:"empty"},slot:"empty"},[a("p",{style:{marginTop:"23px"}},[t._v("暂无数据")])])],1)],1)],1)]),t._v(" "),t.showdialog?a(t.comp.component,{tag:"component",attrs:{childDataUrl:t.childDataUrl,oneCheck:t.oneCheck},on:{hideComponent:t.hideComponent,sureSubmit:t.showMsgfromchild}}):t._e()],1)],1)],1)},staticRenderFns:[]};var C=a(47)(f,v,!1,function(t){a(756)},"data-v-3e9e8638",null);e.default=C.exports}});