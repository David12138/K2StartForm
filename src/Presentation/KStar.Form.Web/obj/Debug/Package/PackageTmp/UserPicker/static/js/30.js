webpackJsonp([30],{685:function(e,t,a){"use strict";var s={name:"page",props:{pageIndex:{type:Number,default:1,required:!0},pageSize:{type:Number,default:1,required:!0},total:{type:Number,default:0,required:!0},pageSizesList:{type:Array,required:!0}},data:function(){return{}},methods:{handleSizeChange:function(e){this.$emit("handleSizeChange",e)},handleCurrentChange:function(e){this.$emit("handleCurrentChange",e)},firstPage:function(){this.pageIndex=1},tailPage:function(){this.pageIndex=this.$refs.page.internalPageCount}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("el-pagination",{ref:"page",attrs:{background:"","current-page":e.pageIndex,"page-sizes":e.pageSizesList,"page-size":e.pageSize,"prev-text":e.$t("UserPicker.HomePage"),"next-text":e.$t("UserPicker.TailPage"),layout:"total, prev, pager, next, sizes",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"prev-click":e.firstPage,"next-click":e.tailPage}})],1)},staticRenderFns:[]};var r=a(47)(s,i,!1,function(e){a(687)},"data-v-18a42a56",null).exports;t.a=r},687:function(e,t){},755:function(e,t){},794:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(160),i=a.n(s),r=a(360),o=a.n(r),n=a(361),l=a(67),c=a(359),h={name:"opinionReports",data:function(){var e;return e={isShow:!0,showdialog:!1,showList:!1,fullHeight:document.documentElement.clientHeight,arrt:"收起",icon:"el-icon-arrow-down",total:0,comp:{},hintwring:"",hintwringShow:!1,pageIndex:1,orgStates:[]},o()(e,"total",0),o()(e,"queryName",""),o()(e,"multiplelimit",1),o()(e,"loading",!1),o()(e,"pageSize",10),o()(e,"pageSizesList",[10,20,50,100]),o()(e,"childDataUrl",{url:"",selectedPerson:[],chooseProject:{}}),o()(e,"model",{selectForm:{userID:""},userName:[]}),o()(e,"filterEmptyComment",0),o()(e,"orderBy",""),o()(e,"fa",!1),o()(e,"exportTotal",[]),o()(e,"oneCheck",!0),o()(e,"tableData",[]),o()(e,"imgLoading",!1),e},methods:{emptyselect:function(){this.childDataUrl.selectedPerson=[],this.model.userName=[]},getUsers:function(e){var t=this,a=this;a.orgStates=[],a.$axios.post("/api/getUser",{name:e,deptId:"",isWork:"1"}).then(function(e){for(var s=0;s<e.data.result.length;s++)a.orgStates.push({value:e.data.result[s].displayName,userId:e.data.result[s].adAccount,orgFullPath:e.data.result[s].orgNameFullPath,vankeId:e.data.result[s].vankeId});t.loading=!1}).catch(function(e){a.$message.error("查询列表数据失败!ERROR MESSAGE:"+e)})},querySearchUser:function(e){if(this.queryName=e,this.orgStates=[],0==this.model.userName.length){this.hintwring="",this.hintwringShow=!1;var t=this;if(this.loading=!0,this.isSeach)return;this.isSeach=!0,setTimeout(function(){t.isSeach=!1,t.validationInput(t.queryName)},2e3)}else""==e.trim()?(this.hintwringShow=!1,this.hintwring=""):(this.hintwringShow=!0,this.hintwring="注意：此处账号选择只能单选！")},personChange:function(e){this.$set(this.$refs.userId,"query",""),this.childDataUrl.selectedPerson[0]=e},removeUser:function(e){if(e.userId){for(var t=0;t<this.childDataUrl.selectedPerson.length&&e.userId!=this.childDataUrl.selectedPerson[t].userId;t++);this.childDataUrl.selectedPerson.splice(t,1)}else{for(t=0;t<this.childDataUrl.selectedPerson.length&&e!=this.childDataUrl.selectedPerson[t].value;t++);this.childDataUrl.selectedPerson.splice(t,1)}},validationInput:function(e){if(""==e||0==e.length)return this.loading=!1,null;e==this.$refs.userId.query?this.getUsers(e):this.orgStates=[]},visibleChange:function(e){this.orgStates=[],e||(this.hintwringShow=!1,this.hintwring="")},handleSizeChange:function(e){var t=""+e;this.pageIndex=1,this.pageSize=parseInt(t),localStorage.myInitPageSize=e,this.select()},handleCurrentChange:function(e){this.pageIndex=e,this.select()},sortChange:function(e){0!==this.model.userName.length&&(this.orderBy=e.prop+" "+e.order.replace("ending",""),this.select())},isChecked:function(e){this.filterEmptyComment=1==e?1:0},exportList:function(){var e=this;if(0!=e.childDataUrl.selectedPerson.length){e.model.selectForm.orderBy=e.orderBy,e.model.selectForm.filterEmptyComment=e.filterEmptyComment,localStorage.todoPageSize&&(e.pageSize=Number(localStorage.todoPageSize));var t="";e.model.selectForm.userID="";var a=!0,s=!1,r=void 0;try{for(var o,n=i()(e.childDataUrl.selectedPerson);!(a=(o=n.next()).done);a=!0){t+="VANKE\\"+o.value.userId+";"}}catch(e){s=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(s)throw r}}t&&(e.model.selectForm.userID=t.substring(0,t.length-1)),c.a.startLoading({lock:!0,text:"数据量过大，正在拼命加载中...",background:"rgba(255, 255, 255, 0.9)",target:document.querySelector(".loadingtext")}),e.$axios.post("/api/exportExcelForTable",{tableName:"动态-动态-岗位/人-审批意见的统计",params:e.model.selectForm},{responseType:"blob"}).then(function(e){var t=e.data;l.a.exportSearchList("动态-动态-岗位/人-审批意见的统计",t),c.a.endLoading()}).catch(function(t){c.a.endLoading(),e.$message.error("导出Excel失败!ERROR MESSAGE:"+t)})}else e.$message.warning("请选择账号！做导出数据条件！")},select:function(){var e=this;this.model.selectForm.orderBy=this.orderBy,this.model.selectForm.filterEmptyComment=this.filterEmptyComment,localStorage.todoPageSize&&(this.pageSize=Number(localStorage.todoPageSize));var t="";this.model.selectForm.userID="";var a=!0,s=!1,r=void 0;try{for(var o,n=i()(this.childDataUrl.selectedPerson);!(a=(o=n.next()).done);a=!0){t+="VANKE\\"+o.value.userId+";"}}catch(e){s=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(s)throw r}}t&&(this.model.selectForm.userID=t.substring(0,t.length-1)),this.imgLoading=!0,this.model.selectForm.pageIndex=this.pageIndex-1,this.model.selectForm.pageSize=this.pageSize,this.$axios.post("/api/ApprovalOpinions/page",this.model.selectForm).then(function(t){e.tableData=t.data.approvalOpinionsList,e.total=t.data.total,e.imgLoading=!1}).catch(function(t){e.$message.error("查询列表数据失败!ERROR MESSAGE:"+t),e.imgLoading=!1}),this.model.selectForm={}},showMsgfromchild:function(e){if(e.type&&"project"==e.type)if(this.oneCheck){var t=e.last.lastNode;this.model.companys_t=t,this.model.companys=t,this.model.companys.length>15&&(this.model.companys=this.model.companys.substr(0,20)+"..."),this.model.selectForm.departmentID=e.item.orgID,this.model.selectForm.companyCode=e.last.lastId.toString()}else e.items;else if(e.type&&"process"==e.type)this.processFormName=e.text,this.model.selectForm.processID=e.processID;else if(e.type&&"originator"==e.type){this.childDataUrl.selectedPerson=[],this.model.userName=[];var a=!0,s=!1,r=void 0;try{for(var o,n=i()(e.peoArr);!(a=(o=n.next()).done);a=!0){for(var l=o.value,c=l.userId,h=l.vankeId,d=!1,u=0;u<this.childDataUrl.selectedPerson.length;u++)this.childDataUrl.selectedPerson[u].userId===c&&(d=!0);d||(this.childDataUrl.selectedPerson.push({userId:c,value:l.name,vankeId:h}),this.model.userName.push(l.name))}}catch(e){s=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(s)throw r}}}this.hideComponent()},inquire:function(){this.pageIndex=1,0==this.model.userName.length?this.$message.warning("请选择账号!"):this.select()},refresh:function(){var e=this;this.orderBy="",this.filterEmptyComment=0,this.fa=!1,this.$nextTick(function(){e.model.selectForm.userID="",e.model.userName=[],e.childDataUrl.selectedPerson=[]})},showToggle:function(){this.showList=!this.showList,this.isShow=!this.isShow,this.isShow?(this.arrt="收起",this.icon="el-icon-arrow-up"):(this.arrt="展开",this.icon="el-icon-arrow-down")},sureSubmit:function(e){},openDialog:function(e,t){this.comp.component=e,this.showdialog=!0,l.a.showDailog_mask(),"originator_dailog"==e?(this.oneCheck=!0,this.childDataUrl.getTree="getTree",this.childDataUrl.companytree="companytree/page"):"project_dialog"==e&&(this.childDataUrl.getTree="getTree",this.childDataUrl.companytree="companytree/page")},hideComponent:function(){this.showdialog=!1,l.a.hiddenDailog_mask()}},mounted:function(){},watch:{fullHeight:function(){return document.documentElement.clientHeight}},components:{page:a(685).a,originator_dailog:n.a}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"opinionReports staticReports"},[a("el-container",[a("el-header",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"loadingtext staticReports minWidth",attrs:{"element-loading-text":"加载中...","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[a("div",{staticClass:"taticReports-content"},[a("el-row",{staticClass:"staticReports-header",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{staticClass:"titleMT",attrs:{span:17}},[a("span",{staticClass:"mz",on:{click:function(t){e.$router.back(-1)}}},[e._v("流程报表")]),a("i",{class:e.icon})]),e._v(" "),a("el-col",{staticClass:"titleBtn clearfix",attrs:{span:6}},[a("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.refresh}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{round:"",type:"primary",size:"mini"},on:{click:e.inquire}},[e._v("搜索")])],1)],1),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"statement reportCondition"},[a("span",{staticClass:"fz16"},[e._v("动态-动态-岗位/人-审批意见的统计")]),e._v(" "),a("el-row",{staticClass:"staticReports-middle lh35 staticReportsMiddle"},[a("el-col",{staticClass:"processSelect",attrs:{sm:4,md:1}},[a("span",[e._v("账号选择")])]),e._v(" "),a("el-col",{staticClass:"classSelectMR  process-inputbox",attrs:{span:7}},[a("i",{staticClass:"iconfont icon-member",on:{click:function(t){e.openDialog("originator_dailog")}}}),e._v(" "),a("el-select",{ref:"userId",attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"","popper-class":"orgstates","remote-method":e.querySearchUser,"value-key":"userId",placeholder:"",loading:e.loading},on:{change:e.personChange,"visible-change":e.visibleChange,"remove-tag":e.removeUser,clear:e.emptyselect},model:{value:e.model.userName[0],callback:function(t){e.$set(e.model.userName,0,t)},expression:"model.userName[0]"}},e._l(e.orgStates,function(t,s){return a("el-option",{key:s,attrs:{label:t.value,value:t}},[a("div",{staticClass:"userheight",staticStyle:{"font-weight":"600"}},[e._v(e._s(t.value)+"("+e._s(t.userId)+")")]),e._v(" "),a("div",{staticClass:"fullpathsize"},[e._v(e._s(t.orgFullPath))])])}))],1),e._v(" "),a("el-col",{attrs:{span:5}},[a("i",{class:[e.hintwringShow?"el-icon-warning":""]}),a("span",[e._v(e._s(e.hintwring)+" ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-checkbox",{on:{change:e.isChecked},model:{value:e.fa,callback:function(t){e.fa=t},expression:"fa"}},[e._v("过滤掉为“空”的意见")])],1)],1),e._v(" "),a("el-row",[a("el-col",{staticClass:"buttonWrap buttonWrapTA",attrs:{span:4}},[a("el-button",{staticClass:"upload",attrs:{round:"",type:"primary",icon:"iconfont icon-export",size:"mini"},on:{click:function(t){e.exportList()}}},[e._v("导出\n              ")])],1)],1)],1),e._v(" "),a("div",{staticClass:"statement"},[a("el-table",{ref:"singleTable",attrs:{data:e.tableData,"highlight-current-row":"",border:"",height:e.showList?e.fullHeight-405:e.fullHeight-280},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{property:"procInstNO",label:"流程实例编号",width:"150",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{property:"processName",label:"流程名称",align:"left",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{property:"topic",width:"125",label:"流程主题",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{property:"activityName",label:"环节名称",width:"150",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{property:"approval",label:"审批结果",width:"100",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{property:"comment",label:"审批意见",width:"120",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{innerHTML:e._s(t.row.comment)}})]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"approvalDate",label:"审批时间",width:"150",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("moment")(t.row.approvalDate,"YYYY-MM-DD")))]}}])}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.imgLoading,expression:"!imgLoading"}],attrs:{slot:"empty"},slot:"empty"},[a("p",{style:{marginTop:"23px"}},[e._v("暂无数据")])]),e._v(" "),a("div",{attrs:{slot:"append"},slot:"append"},[a("page",{attrs:{pageIndex:e.pageIndex,total:e.total,pageSize:e.pageSize,pageSizesList:e.pageSizesList},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)],1)],1)],1)]),e._v(" "),e.showdialog?a(e.comp.component,{tag:"component",attrs:{oneCheck:e.oneCheck,childDataUrl:e.childDataUrl,queryName:e.queryName},on:{hideComponent:e.hideComponent,sureSubmit:e.showMsgfromchild}}):e._e()],1)],1)],1)},staticRenderFns:[]};var u=a(47)(h,d,!1,function(e){a(755)},"data-v-76ac6d9b",null);t.default=u.exports}});